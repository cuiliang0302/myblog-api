import{z as Ht,C as Lt,D as Z,F as Pt,G as Ft,H as Ut,h as _,I as Xt,f as j,g as Y,x as G,J as ge,i as E,K as se,L as Ce,M as $t,t as ee,N as Qe,a as W,r as Ie,O as et,P as tt,w as T,u as $,p as rt,k as ot,j as J,l as oe,m as Ee,Q as it,v as nt,R as jt,S as Bt,T as Yt,q as Rt,U as Wt,b as Nt,V as Dt,W as qt,y as Pe}from"./index.86bfc3bf.js";import{i as Vt,_ as Me}from"./plugin-vue_export-helper.6457a15f.js";import{t as at}from"./timeFormat.bb534f5d.js";/* empty css                 */var lt={exports:{}};/*!
 * clipboard.js v2.0.10
 * https://clipboardjs.com/
 *
 * Licensed MIT Â© Zeno Rocha
 */(function(e,r){(function(o,n){e.exports=n()})(Ht,function(){return function(){var t={686:function(i,l,s){s.d(l,{default:function(){return Mt}});var d=s(279),a=s.n(d),p=s(370),m=s.n(p),b=s(817),C=s.n(b);function x(A){try{return document.execCommand(A)}catch{return!1}}var w=function(S){var k=C()(S);return x("cut"),k},y=w;function g(A){var S=document.documentElement.getAttribute("dir")==="rtl",k=document.createElement("textarea");k.style.fontSize="12pt",k.style.border="0",k.style.padding="0",k.style.margin="0",k.style.position="absolute",k.style[S?"right":"left"]="-9999px";var O=window.pageYOffset||document.documentElement.scrollTop;return k.style.top="".concat(O,"px"),k.setAttribute("readonly",""),k.value=A,k}var v=function(S){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},O="";if(typeof S=="string"){var z=g(S);k.container.appendChild(z),O=C()(z),x("copy"),z.remove()}else O=C()(S),x("copy");return O},u=v;function c(A){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?c=function(k){return typeof k}:c=function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},c(A)}var h=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=S.action,O=k===void 0?"copy":k,z=S.container,I=S.target,B=S.text;if(O!=="copy"&&O!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(I!==void 0)if(I&&c(I)==="object"&&I.nodeType===1){if(O==="copy"&&I.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(O==="cut"&&(I.hasAttribute("readonly")||I.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(B)return u(B,{container:z});if(I)return O==="cut"?y(I):u(I,{container:z})},f=h;function M(A){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?M=function(k){return typeof k}:M=function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},M(A)}function F(A,S){if(!(A instanceof S))throw new TypeError("Cannot call a class as a function")}function X(A,S){for(var k=0;k<S.length;k++){var O=S[k];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(A,O.key,O)}}function H(A,S,k){return S&&X(A.prototype,S),k&&X(A,k),A}function zt(A,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(S&&S.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),S&&we(A,S)}function we(A,S){return we=Object.setPrototypeOf||function(O,z){return O.__proto__=z,O},we(A,S)}function At(A){var S=It();return function(){var O=ae(A),z;if(S){var I=ae(this).constructor;z=Reflect.construct(O,arguments,I)}else z=O.apply(this,arguments);return Ot(this,z)}}function Ot(A,S){return S&&(M(S)==="object"||typeof S=="function")?S:Tt(A)}function Tt(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}function It(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ae(A){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(k){return k.__proto__||Object.getPrototypeOf(k)},ae(A)}function _e(A,S){var k="data-clipboard-".concat(A);if(!!S.hasAttribute(k))return S.getAttribute(k)}var Et=function(A){zt(k,A);var S=At(k);function k(O,z){var I;return F(this,k),I=S.call(this),I.resolveOptions(z),I.listenClick(O),I}return H(k,[{key:"resolveOptions",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof z.action=="function"?z.action:this.defaultAction,this.target=typeof z.target=="function"?z.target:this.defaultTarget,this.text=typeof z.text=="function"?z.text:this.defaultText,this.container=M(z.container)==="object"?z.container:document.body}},{key:"listenClick",value:function(z){var I=this;this.listener=m()(z,"click",function(B){return I.onClick(B)})}},{key:"onClick",value:function(z){var I=z.delegateTarget||z.currentTarget,B=this.action(I)||"copy",le=f({action:B,container:this.container,target:this.target(I),text:this.text(I)});this.emit(le?"success":"error",{action:B,text:le,trigger:I,clearSelection:function(){I&&I.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(z){return _e("action",z)}},{key:"defaultTarget",value:function(z){var I=_e("target",z);if(I)return document.querySelector(I)}},{key:"defaultText",value:function(z){return _e("text",z)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(z){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return u(z,I)}},{key:"cut",value:function(z){return y(z)}},{key:"isSupported",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],I=typeof z=="string"?[z]:z,B=!!document.queryCommandSupported;return I.forEach(function(le){B=B&&!!document.queryCommandSupported(le)}),B}}]),k}(a()),Mt=Et},828:function(i){var l=9;if(typeof Element!="undefined"&&!Element.prototype.matches){var s=Element.prototype;s.matches=s.matchesSelector||s.mozMatchesSelector||s.msMatchesSelector||s.oMatchesSelector||s.webkitMatchesSelector}function d(a,p){for(;a&&a.nodeType!==l;){if(typeof a.matches=="function"&&a.matches(p))return a;a=a.parentNode}}i.exports=d},438:function(i,l,s){var d=s(828);function a(b,C,x,w,y){var g=m.apply(this,arguments);return b.addEventListener(x,g,y),{destroy:function(){b.removeEventListener(x,g,y)}}}function p(b,C,x,w,y){return typeof b.addEventListener=="function"?a.apply(null,arguments):typeof x=="function"?a.bind(null,document).apply(null,arguments):(typeof b=="string"&&(b=document.querySelectorAll(b)),Array.prototype.map.call(b,function(g){return a(g,C,x,w,y)}))}function m(b,C,x,w){return function(y){y.delegateTarget=d(y.target,C),y.delegateTarget&&w.call(b,y)}}i.exports=p},879:function(i,l){l.node=function(s){return s!==void 0&&s instanceof HTMLElement&&s.nodeType===1},l.nodeList=function(s){var d=Object.prototype.toString.call(s);return s!==void 0&&(d==="[object NodeList]"||d==="[object HTMLCollection]")&&"length"in s&&(s.length===0||l.node(s[0]))},l.string=function(s){return typeof s=="string"||s instanceof String},l.fn=function(s){var d=Object.prototype.toString.call(s);return d==="[object Function]"}},370:function(i,l,s){var d=s(879),a=s(438);function p(x,w,y){if(!x&&!w&&!y)throw new Error("Missing required arguments");if(!d.string(w))throw new TypeError("Second argument must be a String");if(!d.fn(y))throw new TypeError("Third argument must be a Function");if(d.node(x))return m(x,w,y);if(d.nodeList(x))return b(x,w,y);if(d.string(x))return C(x,w,y);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function m(x,w,y){return x.addEventListener(w,y),{destroy:function(){x.removeEventListener(w,y)}}}function b(x,w,y){return Array.prototype.forEach.call(x,function(g){g.addEventListener(w,y)}),{destroy:function(){Array.prototype.forEach.call(x,function(g){g.removeEventListener(w,y)})}}}function C(x,w,y){return a(document.body,x,w,y)}i.exports=p},817:function(i){function l(s){var d;if(s.nodeName==="SELECT")s.focus(),d=s.value;else if(s.nodeName==="INPUT"||s.nodeName==="TEXTAREA"){var a=s.hasAttribute("readonly");a||s.setAttribute("readonly",""),s.select(),s.setSelectionRange(0,s.value.length),a||s.removeAttribute("readonly"),d=s.value}else{s.hasAttribute("contenteditable")&&s.focus();var p=window.getSelection(),m=document.createRange();m.selectNodeContents(s),p.removeAllRanges(),p.addRange(m),d=p.toString()}return d}i.exports=l},279:function(i){function l(){}l.prototype={on:function(s,d,a){var p=this.e||(this.e={});return(p[s]||(p[s]=[])).push({fn:d,ctx:a}),this},once:function(s,d,a){var p=this;function m(){p.off(s,m),d.apply(a,arguments)}return m._=d,this.on(s,m,a)},emit:function(s){var d=[].slice.call(arguments,1),a=((this.e||(this.e={}))[s]||[]).slice(),p=0,m=a.length;for(p;p<m;p++)a[p].fn.apply(a[p].ctx,d);return this},off:function(s,d){var a=this.e||(this.e={}),p=a[s],m=[];if(p&&d)for(var b=0,C=p.length;b<C;b++)p[b].fn!==d&&p[b].fn._!==d&&m.push(p[b]);return m.length?a[s]=m:delete a[s],this}},i.exports=l,i.exports.TinyEmitter=l}},o={};function n(i){if(o[i])return o[i].exports;var l=o[i]={exports:{}};return t[i](l,l.exports,n),l.exports}return function(){n.n=function(i){var l=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(l,{a:l}),l}}(),function(){n.d=function(i,l){for(var s in l)n.o(l,s)&&!n.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:l[s]})}}(),function(){n.o=function(i,l){return Object.prototype.hasOwnProperty.call(i,l)}}(),n(686)}().default})})(lt);var Gt=Lt(lt.exports),Jt=e=>{const r=(e==null?void 0:e.appendToBody)===void 0?!0:e.appendToBody;return{toClipboard(t,o){return new Promise((n,i)=>{const l=document.createElement("button"),s=new Gt(l,{text:()=>t,action:()=>"copy",container:o!==void 0?o:document.body});s.on("success",d=>{s.destroy(),n(d)}),s.on("error",d=>{s.destroy(),i(d)}),r&&document.body.appendChild(l),l.click(),r&&document.body.removeChild(l)})}}};var ce=2,Fe=.16,Zt=.05,Kt=.05,Qt=.15,st=5,ct=4,er=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Ue(e){var r=e.r,t=e.g,o=e.b,n=Ft(r,t,o);return{h:n.h*360,s:n.s,v:n.v}}function ue(e){var r=e.r,t=e.g,o=e.b;return"#".concat(Pt(r,t,o,!1))}function tr(e,r,t){var o=t/100,n={r:(r.r-e.r)*o+e.r,g:(r.g-e.g)*o+e.g,b:(r.b-e.b)*o+e.b};return n}function Xe(e,r,t){var o;return Math.round(e.h)>=60&&Math.round(e.h)<=240?o=t?Math.round(e.h)-ce*r:Math.round(e.h)+ce*r:o=t?Math.round(e.h)+ce*r:Math.round(e.h)-ce*r,o<0?o+=360:o>=360&&(o-=360),o}function $e(e,r,t){if(e.h===0&&e.s===0)return e.s;var o;return t?o=e.s-Fe*r:r===ct?o=e.s+Fe:o=e.s+Zt*r,o>1&&(o=1),t&&r===st&&o>.1&&(o=.1),o<.06&&(o=.06),Number(o.toFixed(2))}function je(e,r,t){var o;return t?o=e.v+Kt*r:o=e.v-Qt*r,o>1&&(o=1),Number(o.toFixed(2))}function Be(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],o=Z(e),n=st;n>0;n-=1){var i=Ue(o),l=ue(Z({h:Xe(i,n,!0),s:$e(i,n,!0),v:je(i,n,!0)}));t.push(l)}t.push(ue(o));for(var s=1;s<=ct;s+=1){var d=Ue(o),a=ue(Z({h:Xe(d,s),s:$e(d,s),v:je(d,s)}));t.push(a)}return r.theme==="dark"?er.map(function(p){var m=p.index,b=p.opacity,C=ue(tr(Z(r.backgroundColor||"#141414"),Z(t[m]),b*100));return C}):t}var ke={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},U={},Se={};Object.keys(ke).forEach(function(e){U[e]=Be(ke[e]),U[e].primary=U[e][5],Se[e]=Be(ke[e],{theme:"dark",backgroundColor:"#141414"}),Se[e].primary=Se[e][5]});U.red;U.volcano;U.gold;U.orange;U.yellow;U.lime;U.green;U.cyan;U.blue;U.geekblue;U.purple;U.magenta;U.grey;var Ye=[],K=[],rr="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function or(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}function ir(e,r){if(r=r||{},e===void 0)throw new Error(rr);var t=r.prepend===!0?"prepend":"append",o=r.container!==void 0?r.container:document.querySelector("head"),n=Ye.indexOf(o);n===-1&&(n=Ye.push(o)-1,K[n]={});var i;return K[n]!==void 0&&K[n][t]!==void 0?i=K[n][t]:(i=K[n][t]=or(),t==="prepend"?o.insertBefore(i,o.childNodes[0]):o.appendChild(i)),e.charCodeAt(0)===65279&&(e=e.substr(1,e.length)),i.styleSheet?i.styleSheet.cssText+=e:i.textContent+=e,i}var nr={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},ar=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Re=!1,lr=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ar;Ut(function(){Re||(typeof window!="undefined"&&window.document&&window.document.documentElement&&ir(r,{prepend:!0}),Re=!0)})},sr=["class","component","viewBox","spin","rotate","tabindex","onClick"];function pe(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?Object(arguments[r]):{},o=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.forEach(function(n){ut(e,n,t[n])})}return e}function ut(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function cr(e,r){if(e==null)return{};var t=ur(e,r),o,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],!(r.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,o)||(t[o]=e[o]))}return t}function ur(e,r){if(e==null)return{};var t={},o=Object.keys(e),n,i;for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(t[n]=e[n]);return t}var ye=function(r,t){var o=t.attrs,n=t.slots,i=pe({},r,o),l=i.class,s=i.component,d=i.viewBox,a=i.spin,p=i.rotate,m=i.tabindex,b=i.onClick,C=cr(i,sr),x=n.default&&n.default(),w=x&&x.length,y=n.component;lr();var g=ut({anticon:!0},l,l),v={"anticon-spin":a===""||!!a},u=p?{msTransform:"rotate(".concat(p,"deg)"),transform:"rotate(".concat(p,"deg)")}:void 0,c=pe({},nr,{viewBox:d,class:v,style:u});d||delete c.viewBox;var h=function(){return s?_(s,c,{default:function(){return[x]}}):y?y(c):w?(Boolean(d)||x.length===1&&x[0]&&x[0].type,_("svg",pe({},c,{viewBox:d}),[x])):null},f=m;return f===void 0&&b&&(f=-1,C.tabindex=f),_("span",pe({role:"img"},C,{onClick:b,class:g}),[h()])};ye.props={spin:Boolean,rotate:Number,viewBox:String,ariaLabel:String};ye.inheritAttrs=!1;ye.displayName="Icon";var pr=ye,dr=["type"];function We(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?Object(arguments[r]):{},o=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.forEach(function(n){hr(e,n,t[n])})}return e}function hr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function fr(e,r){if(e==null)return{};var t=gr(e,r),o,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],!(r.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,o)||(t[o]=e[o]))}return t}function gr(e,r){if(e==null)return{};var t={},o=Object.keys(e),n,i;for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(t[n]=e[n]);return t}var pt=new Set;function vr(e){return typeof e=="string"&&e.length&&!pt.has(e)}function ve(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=e[r];if(vr(t)){var o=document.createElement("script");o.setAttribute("src",t),o.setAttribute("data-namespace",t),e.length>r+1&&(o.onload=function(){ve(e,r+1)},o.onerror=function(){ve(e,r+1)}),pt.add(t),document.body.appendChild(o)}}function mr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.scriptUrl,t=e.extraCommonProps,o=t===void 0?{}:t;typeof document!="undefined"&&typeof window!="undefined"&&typeof document.createElement=="function"&&(Array.isArray(r)?ve(r.reverse()):ve([r]));var n=function(l,s){var d=s.attrs,a=s.slots,p=We({},l,d),m=p.type,b=fr(p,dr),C=a.default&&a.default(),x=null;m&&(x=_("use",{"xlink:href":"#".concat(m)},null)),C&&C.length&&(x=C);var w=We({},o,b);return _(pr,w,{default:function(){return[x]}})};return n.props={spin:Boolean,rotate:Number,type:String},n.inheritAttrs=!1,n.displayName="Iconfont",n}function dt(){return{MyIcon:mr({scriptUrl:"//at.alicdn.com/t/font_2697113_7qeujo2lc8p.js"})}}const ht={};ht.getData=e=>new Promise((r,t)=>{let o={};br(e).then(n=>{o.arrayBuffer=n,o.orientation=_r(n),r(o)}).catch(n=>{t(n)})});function br(e){let r=null;return new Promise((t,o)=>{if(e.src)if(/^data\:/i.test(e.src))r=xr(e.src),t(r);else if(/^blob\:/i.test(e.src)){var n=new FileReader;n.onload=function(l){r=l.target.result,t(r)},yr(e.src,function(l){n.readAsArrayBuffer(l)})}else{var i=new XMLHttpRequest;i.onload=function(){if(this.status==200||this.status===0)r=i.response,t(r);else throw"Could not load image";i=null},i.open("GET",e.src,!0),i.responseType="arraybuffer",i.send(null)}else o("img error")})}function yr(e,r){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(o){(this.status==200||this.status===0)&&r(this.response)},t.send()}function xr(e){e=e.replace(/^data\:([^\;]+)\;base64,/gmi,"");for(var r=atob(e),t=r.length,o=new ArrayBuffer(t),n=new Uint8Array(o),i=0;i<t;i++)n[i]=r.charCodeAt(i);return o}function wr(e,r,t){var o="",n;for(n=r,t+=r;n<t;n++)o+=String.fromCharCode(e.getUint8(n));return o}function _r(e){var r=new DataView(e),t=r.byteLength,o,n,i,l,s,d,a,p,m,b;if(r.getUint8(0)===255&&r.getUint8(1)===216)for(m=2;m<t;){if(r.getUint8(m)===255&&r.getUint8(m+1)===225){a=m;break}m++}if(a&&(n=a+4,i=a+10,wr(r,n,4)==="Exif"&&(d=r.getUint16(i),s=d===18761,(s||d===19789)&&r.getUint16(i+2,s)===42&&(l=r.getUint32(i+4,s),l>=8&&(p=i+l)))),p){for(t=r.getUint16(p,s),b=0;b<t;b++)if(m=p+b*12+2,r.getUint16(m,s)===274){m+=8,o=r.getUint16(m,s);break}}return o}var Cr=(e,r)=>{const t=e.__vccOpts||e;for(const[o,n]of r)t[o]=n;return t};const kr=Xt({data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:()=>[1,1]},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:[Number,String],default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"},limitMinSize:{type:[Number,Array,String],default:()=>10}},computed:{cropInfo(){let e={};if(e.top=this.cropOffsertY>21?"-21px":"0px",e.width=this.cropW>0?this.cropW:0,e.height=this.cropH>0?this.cropH:0,this.infoTrue){let r=1;this.high&&!this.full&&(r=window.devicePixelRatio),this.enlarge!==1&!this.full&&(r=Math.abs(Number(this.enlarge))),e.width=e.width*r,e.height=e.height*r,this.full&&(e.width=e.width/this.scale,e.height=e.height/this.scale)}return e.width=e.width.toFixed(0),e.height=e.height.toFixed(0),e},isIE(){return!!window.ActiveXObject||"ActiveXObject"in window},passive(){return this.isIE?null:{passive:!1}}},watch:{img(){this.checkedImg()},imgs(e){e!==""&&this.reload()},cropW(){this.showPreview()},cropH(){this.showPreview()},cropOffsertX(){this.showPreview()},cropOffsertY(){this.showPreview()},scale(e,r){this.showPreview()},x(){this.showPreview()},y(){this.showPreview()},autoCrop(e){e&&this.goAutoCrop()},autoCropWidth(){this.autoCrop&&this.goAutoCrop()},autoCropHeight(){this.autoCrop&&this.goAutoCrop()},mode(){this.checkedImg()},rotate(){this.showPreview(),this.autoCrop?this.goAutoCrop(this.cropW,this.cropH):(this.cropW>0||this.cropH>0)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{getVersion(e){var r=navigator.userAgent.split(" "),t="";let o=0;const n=new RegExp(e,"i");for(var i=0;i<r.length;i++)n.test(r[i])&&(t=r[i]);return t?o=t.split("/")[1].split("."):o=["0","0","0"],o},checkOrientationImage(e,r,t,o){if(this.getVersion("chrome")[0]>=81)r=-1;else if(this.getVersion("safari")[0]>=605){const l=this.getVersion("version");l[0]>13&&l[1]>1&&(r=-1)}else{const l=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);if(l){let s=l[1];s=s.split("_"),(s[0]>13||s[0]>=13&&s[1]>=4)&&(r=-1)}}let n=document.createElement("canvas"),i=n.getContext("2d");switch(i.save(),r){case 2:n.width=t,n.height=o,i.translate(t,0),i.scale(-1,1);break;case 3:n.width=t,n.height=o,i.translate(t/2,o/2),i.rotate(180*Math.PI/180),i.translate(-t/2,-o/2);break;case 4:n.width=t,n.height=o,i.translate(0,o),i.scale(1,-1);break;case 5:n.height=t,n.width=o,i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:n.width=o,n.height=t,i.translate(o/2,t/2),i.rotate(90*Math.PI/180),i.translate(-t/2,-o/2);break;case 7:n.height=t,n.width=o,i.rotate(.5*Math.PI),i.translate(t,-o),i.scale(-1,1);break;case 8:n.height=t,n.width=o,i.translate(o/2,t/2),i.rotate(-90*Math.PI/180),i.translate(-t/2,-o/2);break;default:n.width=t,n.height=o}i.drawImage(e,0,0,t,o),i.restore(),n.toBlob(l=>{let s=URL.createObjectURL(l);URL.revokeObjectURL(this.imgs),this.imgs=s},"image/"+this.outputType,1)},checkedImg(){if(this.img===null||this.img===""){this.imgs="",this.clearCrop();return}this.loading=!0,this.scale=1,this.rotate=0,this.clearCrop();let e=new Image;if(e.onload=()=>{if(this.img==="")return this.$emit("img-load","error"),!1;let t=e.width,o=e.height;ht.getData(e).then(n=>{this.orientation=n.orientation||1;let i=Number(this.maxImgSize);if(!this.orientation&&t<i&o<i){this.imgs=this.img;return}t>i&&(o=o/t*i,t=i),o>i&&(t=t/o*i,o=i),this.checkOrientationImage(e,this.orientation,t,o)})},e.onerror=()=>{this.$emit("img-load","error")},this.img.substr(0,4)!=="data"&&(e.crossOrigin=""),this.isIE){var r=new XMLHttpRequest;r.onload=function(){var t=URL.createObjectURL(this.response);e.src=t},r.open("GET",this.img,!0),r.responseType="blob",r.send()}else e.src=this.img},startMove(e){if(e.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=("clientX"in e?e.clientX:e.touches[0].clientX)-this.x,this.moveY=("clientY"in e?e.clientY:e.touches[0].clientY)-this.y,e.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),e.touches.length==2&&(this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("imgMoving",{moving:!0,axis:this.getImgAxis()}),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=e.offsetX?e.offsetX:e.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=e.offsetY?e.offsetY:e.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale(e){e.preventDefault();let r=this.scale;var t={x:this.touches[0].clientX,y:this.touches[0].clientY},o={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:this.touches[1].clientX,y:this.touches[1].clientY},i={x:e.touches[1].clientX,y:e.touches[1].clientY},l=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),s=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)),d=s-l,a=1;a=a/this.trueWidth>a/this.trueHeight?a/this.trueHeight:a/this.trueWidth,a=a>.1?.1:a;var p=a*d;if(!this.touchNow){if(this.touchNow=!0,d>0?r+=Math.abs(p):d<0&&r>Math.abs(p)&&(r-=Math.abs(p)),this.touches=e.touches,setTimeout(()=>{this.touchNow=!1},8),!this.checkoutImgAxis(this.x,this.y,r))return!1;this.scale=r}},cancelTouchScale(e){window.removeEventListener("touchmove",this.touchScale)},moveImg(e){if(e.preventDefault(),e.touches&&e.touches.length===2)return this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;let r="clientX"in e?e.clientX:e.touches[0].clientX,t="clientY"in e?e.clientY:e.touches[0].clientY,o,n;o=r-this.moveX,n=t-this.moveY,this.$nextTick(()=>{if(this.centerBox){let i=this.getImgAxis(o,n,this.scale),l=this.getCropAxis(),s=this.trueHeight*this.scale,d=this.trueWidth*this.scale,a,p,m,b;switch(this.rotate){case 1:case-1:case 3:case-3:a=this.cropOffsertX-this.trueWidth*(1-this.scale)/2+(s-d)/2,p=this.cropOffsertY-this.trueHeight*(1-this.scale)/2+(d-s)/2,m=a-s+this.cropW,b=p-d+this.cropH;break;default:a=this.cropOffsertX-this.trueWidth*(1-this.scale)/2,p=this.cropOffsertY-this.trueHeight*(1-this.scale)/2,m=a-d+this.cropW,b=p-s+this.cropH;break}i.x1>=l.x1&&(o=a),i.y1>=l.y1&&(n=p),i.x2<=l.x2&&(o=m),i.y2<=l.y2&&(n=b)}this.x=o,this.y=n,this.$emit("imgMoving",{moving:!0,axis:this.getImgAxis()}),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})})},leaveImg(e){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("imgMoving",{moving:!1,axis:this.getImgAxis()}),this.$emit("img-moving",{moving:!1,axis:this.getImgAxis()})},scaleImg(){this.canScale&&window.addEventListener(this.support,this.changeSize,this.passive)},cancelScale(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize(e){e.preventDefault();let r=this.scale;var t=e.deltaY||e.wheelDelta,o=navigator.userAgent.indexOf("Firefox");t=o>0?t*30:t,this.isIE&&(t=-t);var n=this.coe;n=n/this.trueWidth>n/this.trueHeight?n/this.trueHeight:n/this.trueWidth;var i=n*t;i<0?r+=Math.abs(i):r>Math.abs(i)&&(r-=Math.abs(i));let l=i<0?"add":"reduce";if(l!==this.coeStatus&&(this.coeStatus=l,this.coe=.2),this.scaling||(this.scalingSet=setTimeout(()=>{this.scaling=!1,this.coe=this.coe+=.01},50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,r))return!1;this.scale=r},changeScale(e){let r=this.scale;e=e||1;var t=20;if(t=t/this.trueWidth>t/this.trueHeight?t/this.trueHeight:t/this.trueWidth,e=e*t,e>0?r+=Math.abs(e):r>Math.abs(e)&&(r-=Math.abs(e)),!this.checkoutImgAxis(this.x,this.y,r))return!1;this.scale=r},createCrop(e){e.preventDefault();var r="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,t="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;this.$nextTick(()=>{var o=r-this.cropX,n=t-this.cropY;if(o>0?(this.cropW=o+this.cropChangeX>this.w?this.w-this.cropChangeX:o,this.cropOffsertX=this.cropChangeX):(this.cropW=this.w-this.cropChangeX+Math.abs(o)>this.w?this.cropChangeX:Math.abs(o),this.cropOffsertX=this.cropChangeX+o>0?this.cropChangeX+o:0),!this.fixed)n>0?(this.cropH=n+this.cropChangeY>this.h?this.h-this.cropChangeY:n,this.cropOffsertY=this.cropChangeY):(this.cropH=this.h-this.cropChangeY+Math.abs(n)>this.h?this.cropChangeY:Math.abs(n),this.cropOffsertY=this.cropChangeY+n>0?this.cropChangeY+n:0);else{var i=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];i+this.cropOffsertY>this.h?(this.cropH=this.h-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],o>0?this.cropOffsertX=this.cropChangeX:this.cropOffsertX=this.cropChangeX-this.cropW):this.cropH=i,this.cropOffsertY=this.cropOffsertY}})},changeCropSize(e,r,t,o,n){e.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=r,this.canChangeY=t,this.changeCropTypeX=o,this.changeCropTypeY=n,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0),this.$emit("change-crop-size",{width:this.cropW,height:this.cropH})},changeCropNow(e){e.preventDefault();var r="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,t="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;let o=this.w,n=this.h,i=0,l=0;if(this.centerBox){let s=this.getImgAxis(),d=s.x2,a=s.y2;i=s.x1>0?s.x1:0,l=s.y1>0?s.y1:0,o>d&&(o=d),n>a&&(n=a)}this.$nextTick(()=>{var s=r-this.cropX,d=t-this.cropY;if(this.canChangeX&&(this.changeCropTypeX===1?this.cropOldW-s>0?(this.cropW=o-this.cropChangeX-s<=o-i?this.cropOldW-s:this.cropOldW+this.cropChangeX-i,this.cropOffsertX=o-this.cropChangeX-s<=o-i?this.cropChangeX+s:i):(this.cropW=Math.abs(s)+this.cropChangeX<=o?Math.abs(s)-this.cropOldW:o-this.cropOldW-this.cropChangeX,this.cropOffsertX=this.cropChangeX+this.cropOldW):this.changeCropTypeX===2&&(this.cropOldW+s>0?(this.cropW=this.cropOldW+s+this.cropOffsertX<=o?this.cropOldW+s:o-this.cropOffsertX,this.cropOffsertX=this.cropChangeX):(this.cropW=o-this.cropChangeX+Math.abs(s+this.cropOldW)<=o-i?Math.abs(s+this.cropOldW):this.cropChangeX-i,this.cropOffsertX=o-this.cropChangeX+Math.abs(s+this.cropOldW)<=o-i?this.cropChangeX-Math.abs(s+this.cropOldW):i))),this.canChangeY&&(this.changeCropTypeY===1?this.cropOldH-d>0?(this.cropH=n-this.cropChangeY-d<=n-l?this.cropOldH-d:this.cropOldH+this.cropChangeY-l,this.cropOffsertY=n-this.cropChangeY-d<=n-l?this.cropChangeY+d:l):(this.cropH=Math.abs(d)+this.cropChangeY<=n?Math.abs(d)-this.cropOldH:n-this.cropOldH-this.cropChangeY,this.cropOffsertY=this.cropChangeY+this.cropOldH):this.changeCropTypeY===2&&(this.cropOldH+d>0?(this.cropH=this.cropOldH+d+this.cropOffsertY<=n?this.cropOldH+d:n-this.cropOffsertY,this.cropOffsertY=this.cropChangeY):(this.cropH=n-this.cropChangeY+Math.abs(d+this.cropOldH)<=n-l?Math.abs(d+this.cropOldH):this.cropChangeY-l,this.cropOffsertY=n-this.cropChangeY+Math.abs(d+this.cropOldH)<=n-l?this.cropChangeY-Math.abs(d+this.cropOldH):l))),this.canChangeX&&this.fixed){var a=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];a+this.cropOffsertY>n?(this.cropH=n-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0]):this.cropH=a}if(this.canChangeY&&this.fixed){var p=this.cropH/this.fixedNumber[1]*this.fixedNumber[0];p+this.cropOffsertX>o?(this.cropW=o-this.cropOffsertX,this.cropH=this.cropW/this.fixedNumber[0]*this.fixedNumber[1]):this.cropW=p}})},checkCropLimitSize(){let{cropW:e,cropH:r,limitMinSize:t}=this,o=new Array;return Array.isArray[t]?o=t:o=[t,t],e=parseFloat(o[0]),r=parseFloat(o[1]),[e,r]},changeCropEnd(e){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},endCrop(){this.cropW===0&&this.cropH===0&&(this.cropping=!1),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop(){this.crop=!0},stopCrop(){this.crop=!1},clearCrop(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove(e){if(e.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(e),!1;if(e.touches&&e.touches.length===2)return this.crop=!1,this.startMove(e),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);let r="clientX"in e?e.clientX:e.touches[0].clientX,t="clientY"in e?e.clientY:e.touches[0].clientY,o,n;o=r-this.cropOffsertX,n=t-this.cropOffsertY,this.cropX=o,this.cropY=n,this.$emit("cropMoving",{moving:!0,axis:this.getCropAxis()}),this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})},moveCrop(e,r){let t=0,o=0;e&&(e.preventDefault(),t="clientX"in e?e.clientX:e.touches[0].clientX,o="clientY"in e?e.clientY:e.touches[0].clientY),this.$nextTick(()=>{let n,i,l=t-this.cropX,s=o-this.cropY;if(r&&(l=this.cropOffsertX,s=this.cropOffsertY),l<=0?n=0:l+this.cropW>this.w?n=this.w-this.cropW:n=l,s<=0?i=0:s+this.cropH>this.h?i=this.h-this.cropH:i=s,this.centerBox){let d=this.getImgAxis();n<=d.x1&&(n=d.x1),n+this.cropW>d.x2&&(n=d.x2-this.cropW),i<=d.y1&&(i=d.y1),i+this.cropH>d.y2&&(i=d.y2-this.cropH)}this.cropOffsertX=n,this.cropOffsertY=i,this.$emit("cropMoving",{moving:!0,axis:this.getCropAxis()}),this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})})},getImgAxis(e,r,t){e=e||this.x,r=r||this.y,t=t||this.scale;let o={x1:0,x2:0,y1:0,y2:0},n=this.trueWidth*t,i=this.trueHeight*t;switch(this.rotate){case 0:o.x1=e+this.trueWidth*(1-t)/2,o.x2=o.x1+this.trueWidth*t,o.y1=r+this.trueHeight*(1-t)/2,o.y2=o.y1+this.trueHeight*t;break;case 1:case-1:case 3:case-3:o.x1=e+this.trueWidth*(1-t)/2+(n-i)/2,o.x2=o.x1+this.trueHeight*t,o.y1=r+this.trueHeight*(1-t)/2+(i-n)/2,o.y2=o.y1+this.trueWidth*t;break;default:o.x1=e+this.trueWidth*(1-t)/2,o.x2=o.x1+this.trueWidth*t,o.y1=r+this.trueHeight*(1-t)/2,o.y2=o.y1+this.trueHeight*t;break}return o},getCropAxis(){let e={x1:0,x2:0,y1:0,y2:0};return e.x1=this.cropOffsertX,e.x2=e.x1+this.cropW,e.y1=this.cropOffsertY,e.y2=e.y1+this.cropH,e},leaveCrop(e){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("cropMoving",{moving:!1,axis:this.getCropAxis()}),this.$emit("crop-moving",{moving:!1,axis:this.getCropAxis()})},getCropChecked(e){let r=document.createElement("canvas"),t=new Image,o=this.rotate,n=this.trueWidth,i=this.trueHeight,l=this.cropOffsertX,s=this.cropOffsertY;t.onload=()=>{if(this.cropW!==0){let p=r.getContext("2d"),m=1;this.high&!this.full&&(m=window.devicePixelRatio),this.enlarge!==1&!this.full&&(m=Math.abs(Number(this.enlarge)));let b=this.cropW*m,C=this.cropH*m,x=n*this.scale*m,w=i*this.scale*m,y=(this.x-l+this.trueWidth*(1-this.scale)/2)*m,g=(this.y-s+this.trueHeight*(1-this.scale)/2)*m;switch(a(b,C),p.save(),o){case 0:this.full?(a(b/this.scale,C/this.scale),p.drawImage(t,y/this.scale,g/this.scale,x/this.scale,w/this.scale)):p.drawImage(t,y,g,x,w);break;case 1:case-3:this.full?(a(b/this.scale,C/this.scale),y=y/this.scale+(x/this.scale-w/this.scale)/2,g=g/this.scale+(w/this.scale-x/this.scale)/2,p.rotate(o*90*Math.PI/180),p.drawImage(t,g,-y-w/this.scale,x/this.scale,w/this.scale)):(y=y+(x-w)/2,g=g+(w-x)/2,p.rotate(o*90*Math.PI/180),p.drawImage(t,g,-y-w,x,w));break;case 2:case-2:this.full?(a(b/this.scale,C/this.scale),p.rotate(o*90*Math.PI/180),y=y/this.scale,g=g/this.scale,p.drawImage(t,-y-x/this.scale,-g-w/this.scale,x/this.scale,w/this.scale)):(p.rotate(o*90*Math.PI/180),p.drawImage(t,-y-x,-g-w,x,w));break;case 3:case-1:this.full?(a(b/this.scale,C/this.scale),y=y/this.scale+(x/this.scale-w/this.scale)/2,g=g/this.scale+(w/this.scale-x/this.scale)/2,p.rotate(o*90*Math.PI/180),p.drawImage(t,-g-x/this.scale,y,x/this.scale,w/this.scale)):(y=y+(x-w)/2,g=g+(w-x)/2,p.rotate(o*90*Math.PI/180),p.drawImage(t,-g-x,y,x,w));break;default:this.full?(a(b/this.scale,C/this.scale),p.drawImage(t,y/this.scale,g/this.scale,x/this.scale,w/this.scale)):p.drawImage(t,y,g,x,w)}p.restore()}else{let p=n*this.scale,m=i*this.scale,b=r.getContext("2d");switch(b.save(),o){case 0:a(p,m),b.drawImage(t,0,0,p,m);break;case 1:case-3:a(m,p),b.rotate(o*90*Math.PI/180),b.drawImage(t,0,-m,p,m);break;case 2:case-2:a(p,m),b.rotate(o*90*Math.PI/180),b.drawImage(t,-p,-m,p,m);break;case 3:case-1:a(m,p),b.rotate(o*90*Math.PI/180),b.drawImage(t,-p,0,p,m);break;default:a(p,m),b.drawImage(t,0,0,p,m)}b.restore()}e(r)};var d=this.img.substr(0,4);d!=="data"&&(t.crossOrigin="Anonymous"),t.src=this.imgs;function a(p,m){r.width=Math.round(p),r.height=Math.round(m)}},getCropData(e){this.getCropChecked(r=>{e(r.toDataURL("image/"+this.outputType,this.outputSize))})},getCropBlob(e){this.getCropChecked(r=>{r.toBlob(t=>e(t),"image/"+this.outputType,this.outputSize)})},showPreview(){if(this.isCanShow)this.isCanShow=!1,setTimeout(()=>{this.isCanShow=!0},16);else return!1;let e=this.cropW,r=this.cropH,t=this.scale;var o={};o.div={width:`${e}px`,height:`${r}px`};let n=(this.x-this.cropOffsertX)/t,i=(this.y-this.cropOffsertY)/t,l=0;o.w=e,o.h=r,o.url=this.imgs,o.img={width:`${this.trueWidth}px`,height:`${this.trueHeight}px`,transform:`scale(${t})translate3d(${n}px, ${i}px, ${l}px)rotateZ(${this.rotate*90}deg)`},o.html=`
      <div class="show-preview" style="width: ${o.w}px; height: ${o.h}px,; overflow: hidden">
        <div style="width: ${e}px; height: ${r}px">
          <img src=${o.url} style="width: ${this.trueWidth}px; height: ${this.trueHeight}px; transform:
          scale(${t})translate3d(${n}px, ${i}px, ${l}px)rotateZ(${this.rotate*90}deg)">
        </div>
      </div>`,this.$emit("realTime",o),this.$emit("real-time",o)},reload(){let e=new Image;e.onload=()=>{this.w=parseFloat(window.getComputedStyle(this.$refs.cropper).width),this.h=parseFloat(window.getComputedStyle(this.$refs.cropper).height),this.trueWidth=e.width,this.trueHeight=e.height,this.original?this.scale=1:this.scale=this.checkedMode(),this.$nextTick(()=>{this.x=-(this.trueWidth-this.trueWidth*this.scale)/2+(this.w-this.trueWidth*this.scale)/2,this.y=-(this.trueHeight-this.trueHeight*this.scale)/2+(this.h-this.trueHeight*this.scale)/2,this.loading=!1,this.autoCrop&&this.goAutoCrop(),this.$emit("img-load","success"),this.$emit("imgLoad","success"),setTimeout(()=>{this.showPreview()},20)})},e.onerror=()=>{this.$emit("imgLoad","error"),this.$emit("img-load","error")},e.src=this.imgs},checkedMode(){let e=1,r=this.trueWidth,t=this.trueHeight;const o=this.mode.split(" ");switch(o[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":r=this.w,e=r/this.trueWidth,t=t*e,t<this.h&&(t=this.h,e=t/this.trueHeight);break;default:try{let n=o[0];if(n.search("px")!==-1){n=n.replace("px",""),r=parseFloat(n);const i=r/this.trueWidth;let l=1,s=o[1];s.search("px")!==-1&&(s=s.replace("px",""),t=parseFloat(s),l=t/this.trueHeight),e=Math.min(i,l)}if(n.search("%")!==-1&&(n=n.replace("%",""),r=parseFloat(n)/100*this.w,e=r/this.trueWidth),o.length===2&&n==="auto"){let i=o[1];i.search("px")!==-1&&(i=i.replace("px",""),t=parseFloat(i),e=t/this.trueHeight),i.search("%")!==-1&&(i=i.replace("%",""),t=parseFloat(i)/100*this.h,e=t/this.trueHeight)}}catch{e=1}}return e},goAutoCrop(e,r){if(this.imgs===""||this.imgs===null)return;this.clearCrop(),this.cropping=!0;let t=this.w,o=this.h;if(this.centerBox){const l=Math.abs(this.rotate)%2>0;let s=(l?this.trueHeight:this.trueWidth)*this.scale,d=(l?this.trueWidth:this.trueHeight)*this.scale;t=s<t?s:t,o=d<o?d:o}var n=e||parseFloat(this.autoCropWidth),i=r||parseFloat(this.autoCropHeight);(n===0||i===0)&&(n=t*.8,i=o*.8),n=n>t?t:n,i=i>o?o:i,this.fixed&&(i=n/this.fixedNumber[0]*this.fixedNumber[1]),i>this.h&&(i=this.h,n=i/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(n,i)},changeCrop(e,r){if(this.centerBox){let t=this.getImgAxis();e>t.x2-t.x1&&(e=t.x2-t.x1,r=e/this.fixedNumber[0]*this.fixedNumber[1]),r>t.y2-t.y1&&(r=t.y2-t.y1,e=r/this.fixedNumber[1]*this.fixedNumber[0])}this.cropW=e,this.cropH=r,this.checkCropLimitSize(),this.$nextTick(()=>{this.cropOffsertX=(this.w-this.cropW)/2,this.cropOffsertY=(this.h-this.cropH)/2,this.centerBox&&this.moveCrop(null,!0)})},refresh(){this.img,this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.clearCrop(),this.$nextTick(()=>{this.checkedImg()})},rotateLeft(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight(){this.rotate=this.rotate>=3?0:this.rotate+1},rotateClear(){this.rotate=0},checkoutImgAxis(e,r,t){e=e||this.x,r=r||this.y,t=t||this.scale;let o=!0;if(this.centerBox){let n=this.getImgAxis(e,r,t),i=this.getCropAxis();n.x1>=i.x1&&(o=!1),n.x2<=i.x2&&(o=!1),n.y1>=i.y1&&(o=!1),n.y2<=i.y2&&(o=!1)}return o}},mounted(){this.support="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";let e=this;var r=navigator.userAgent;this.isIOS=!!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,o,n){for(var i=atob(this.toDataURL(o,n).split(",")[1]),l=i.length,s=new Uint8Array(l),d=0;d<l;d++)s[d]=i.charCodeAt(d);t(new Blob([s],{type:e.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},destroyed(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.cancelScale()}}),Sr={key:0,class:"cropper-box"},zr=["src"],Ar={class:"cropper-view-box"},Or=["src"],Tr={key:1};function Ir(e,r,t,o,n,i){return j(),Y("div",{class:"vue-cropper",ref:"cropper",onMouseover:r[28]||(r[28]=(...l)=>e.scaleImg&&e.scaleImg(...l)),onMouseout:r[29]||(r[29]=(...l)=>e.cancelScale&&e.cancelScale(...l))},[e.imgs?(j(),Y("div",Sr,[G(E("div",{class:"cropper-box-canvas",style:se({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"})},[E("img",{src:e.imgs,alt:"cropper-img",ref:"cropperImg"},null,8,zr)],4),[[ge,!e.loading]])])):Ce("",!0),E("div",{class:$t(["cropper-drag-box",{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping}]),onMousedown:r[0]||(r[0]=(...l)=>e.startMove&&e.startMove(...l)),onTouchstart:r[1]||(r[1]=(...l)=>e.startMove&&e.startMove(...l))},null,34),G(E("div",{class:"cropper-crop-box",style:se({width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"})},[E("span",Ar,[E("img",{style:se({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"}),src:e.imgs,alt:"cropper-img"},null,12,Or)]),E("span",{class:"cropper-face cropper-move",onMousedown:r[2]||(r[2]=(...l)=>e.cropMove&&e.cropMove(...l)),onTouchstart:r[3]||(r[3]=(...l)=>e.cropMove&&e.cropMove(...l))},null,32),e.info?(j(),Y("span",{key:0,class:"crop-info",style:se({top:e.cropInfo.top})},ee(e.cropInfo.width)+" \xD7 "+ee(e.cropInfo.height),5)):Ce("",!0),e.fixedBox?Ce("",!0):(j(),Y("span",Tr,[E("span",{class:"crop-line line-w",onMousedown:r[4]||(r[4]=l=>e.changeCropSize(l,!1,!0,0,1)),onTouchstart:r[5]||(r[5]=l=>e.changeCropSize(l,!1,!0,0,1))},null,32),E("span",{class:"crop-line line-a",onMousedown:r[6]||(r[6]=l=>e.changeCropSize(l,!0,!1,1,0)),onTouchstart:r[7]||(r[7]=l=>e.changeCropSize(l,!0,!1,1,0))},null,32),E("span",{class:"crop-line line-s",onMousedown:r[8]||(r[8]=l=>e.changeCropSize(l,!1,!0,0,2)),onTouchstart:r[9]||(r[9]=l=>e.changeCropSize(l,!1,!0,0,2))},null,32),E("span",{class:"crop-line line-d",onMousedown:r[10]||(r[10]=l=>e.changeCropSize(l,!0,!1,2,0)),onTouchstart:r[11]||(r[11]=l=>e.changeCropSize(l,!0,!1,2,0))},null,32),E("span",{class:"crop-point point1",onMousedown:r[12]||(r[12]=l=>e.changeCropSize(l,!0,!0,1,1)),onTouchstart:r[13]||(r[13]=l=>e.changeCropSize(l,!0,!0,1,1))},null,32),E("span",{class:"crop-point point2",onMousedown:r[14]||(r[14]=l=>e.changeCropSize(l,!1,!0,0,1)),onTouchstart:r[15]||(r[15]=l=>e.changeCropSize(l,!1,!0,0,1))},null,32),E("span",{class:"crop-point point3",onMousedown:r[16]||(r[16]=l=>e.changeCropSize(l,!0,!0,2,1)),onTouchstart:r[17]||(r[17]=l=>e.changeCropSize(l,!0,!0,2,1))},null,32),E("span",{class:"crop-point point4",onMousedown:r[18]||(r[18]=l=>e.changeCropSize(l,!0,!1,1,0)),onTouchstart:r[19]||(r[19]=l=>e.changeCropSize(l,!0,!1,1,0))},null,32),E("span",{class:"crop-point point5",onMousedown:r[20]||(r[20]=l=>e.changeCropSize(l,!0,!1,2,0)),onTouchstart:r[21]||(r[21]=l=>e.changeCropSize(l,!0,!1,2,0))},null,32),E("span",{class:"crop-point point6",onMousedown:r[22]||(r[22]=l=>e.changeCropSize(l,!0,!0,1,2)),onTouchstart:r[23]||(r[23]=l=>e.changeCropSize(l,!0,!0,1,2))},null,32),E("span",{class:"crop-point point7",onMousedown:r[24]||(r[24]=l=>e.changeCropSize(l,!1,!0,0,2)),onTouchstart:r[25]||(r[25]=l=>e.changeCropSize(l,!1,!0,0,2))},null,32),E("span",{class:"crop-point point8",onMousedown:r[26]||(r[26]=l=>e.changeCropSize(l,!0,!0,2,2)),onTouchstart:r[27]||(r[27]=l=>e.changeCropSize(l,!0,!0,2,2))},null,32)]))],4),[[ge,e.cropping]])],544)}var He=Cr(kr,[["render",Ir],["__scopeId","data-v-be5e5ddc"]]);typeof window!="undefined"&&window.Vue&&window.Vue.createApp({}).component("VueCropper",He);var ft=globalThis&&globalThis.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i])},e(r,t)};return function(r,t){e(r,t);function o(){this.constructor=r}r.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),L;(function(e){e.InvalidFile="InvalidFile",e.InvalidToken="InvalidToken",e.InvalidMetadata="InvalidMetadata",e.InvalidChunkSize="InvalidChunkSize",e.InvalidCustomVars="InvalidCustomVars",e.NotAvailableUploadHost="NotAvailableUploadHost",e.ReadCacheFailed="ReadCacheFailed",e.InvalidCacheData="InvalidCacheData",e.WriteCacheFailed="WriteCacheFailed",e.RemoveCacheFailed="RemoveCacheFailed",e.GetCanvasContextFailed="GetCanvasContextFailed",e.UnsupportedFileType="UnsupportedFileType",e.FileReaderReadFailed="FileReaderReadFailed",e.NotAvailableXMLHttpRequest="NotAvailableXMLHttpRequest",e.InvalidProgressEventTarget="InvalidProgressEventTarget",e.RequestError="RequestError"})(L||(L={}));var P=function(){function e(r,t){this.name=r,this.message=t,this.stack=new Error().stack}return e}(),ie=function(e){ft(r,e);function r(t,o,n,i){var l=e.call(this,L.RequestError,n)||this;return l.code=t,l.reqId=o,l.isRequestError=!0,l.data=i,l}return r}(P),Er=function(e){ft(r,e);function r(t,o){return o===void 0&&(o=""),e.call(this,0,o,t)||this}return r}(ie),Mr=function(){function e(r,t){this.runTask=r,this.limit=t,this.queue=[],this.processing=[]}return e.prototype.enqueue=function(r){var t=this;return new Promise(function(o,n){t.queue.push({task:r,resolve:o,reject:n}),t.check()})},e.prototype.run=function(r){var t=this;this.queue=this.queue.filter(function(o){return o!==r}),this.processing.push(r),this.runTask(r.task).then(function(){t.processing=t.processing.filter(function(o){return o!==r}),r.resolve(),t.check()},function(o){return r.reject(o)})},e.prototype.check=function(){var r=this,t=this.processing.length,o=this.limit-t;this.queue.slice(0,o).forEach(function(n){r.run(n)})},e}(),Hr=globalThis&&globalThis.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i])},e(r,t)};return function(r,t){e(r,t);function o(){this.constructor=r}r.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),te=globalThis&&globalThis.__assign||function(){return te=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},te.apply(this,arguments)},Lr=function(){function e(){this.closed=!1}return e.prototype.unsubscribe=function(){this.closed||(this.closed=!0,this._unsubscribe&&this._unsubscribe())},e.prototype.add=function(r){this._unsubscribe=r},e}(),Pr=function(e){Hr(r,e);function r(t,o,n){var i=e.call(this)||this;return i.isStopped=!1,t&&typeof t=="object"?i.destination=t:i.destination=te(te(te({},t&&{next:t}),o&&{error:o}),n&&{complete:n}),i}return r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},r.prototype.next=function(t){!this.isStopped&&this.destination.next&&this.destination.next(t)},r.prototype.error=function(t){!this.isStopped&&this.destination.error&&(this.isStopped=!0,this.destination.error(t))},r.prototype.complete=function(t){!this.isStopped&&this.destination.complete&&(this.isStopped=!0,this.destination.complete(t))},r}(Lr),Fr=function(){function e(r){this._subscribe=r}return e.prototype.subscribe=function(r,t,o){var n=new Pr(r,t,o);return n.add(this._subscribe(n)),n},e}();function Ur(e){if(e===null||typeof e=="undefined")return"";var r=e+"",t="",o,n,i=0;o=n=0,i=r.length;for(var l=0;l<i;l++){var s=r.charCodeAt(l),d=null;if(s<128)n++;else if(s>127&&s<2048)d=String.fromCharCode(s>>6|192,s&63|128);else if((s&63488^55296)>0)d=String.fromCharCode(s>>12|224,s>>6&63|128,s&63|128);else{if((s&64512^55296)>0)throw new RangeError("Unmatched trail surrogate at "+l);var a=r.charCodeAt(++l);if((a&64512^56320)>0)throw new RangeError("Unmatched lead surrogate at "+(l-1));s=((s&1023)<<10)+(a&1023)+65536,d=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}d!==null&&(n>o&&(t+=r.slice(o,n)),t+=d,o=n=l+1)}return n>o&&(t+=r.slice(o,i)),t}function Xr(e){var r=[],t=0,o=0,n=0;for(e+="";t<e.length;){o=e.charCodeAt(t)&255,n=0,o<=191?(o=o&127,n=1):o<=223?(o=o&31,n=2):o<=239?(o=o&15,n=3):(o=o&7,n=4);for(var i=1;i<n;++i)o=o<<6|e.charCodeAt(i+t)&63;n===4?(o-=65536,r.push(String.fromCharCode(55296|o>>10&1023)),r.push(String.fromCharCode(56320|o&1023))):r.push(String.fromCharCode(o)),t+=n}return r.join("")}function $r(e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t,o,n,i,l,s,d,a,p=0,m=0,b="",C=[];if(!e)return e;e=Ur(e+"");do t=e.charCodeAt(p++),o=e.charCodeAt(p++),n=e.charCodeAt(p++),a=t<<16|o<<8|n,i=a>>18&63,l=a>>12&63,s=a>>6&63,d=a&63,C[m++]=r.charAt(i)+r.charAt(l)+r.charAt(s)+r.charAt(d);while(p<e.length);switch(b=C.join(""),e.length%3){case 1:b=b.slice(0,-2)+"==";break;case 2:b=b.slice(0,-1)+"=";break}return b}function jr(e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t,o,n,i,l,s,d,a,p=0,m=0,b="",C=[];if(!e)return e;e+="";do i=r.indexOf(e.charAt(p++)),l=r.indexOf(e.charAt(p++)),s=r.indexOf(e.charAt(p++)),d=r.indexOf(e.charAt(p++)),a=i<<18|l<<12|s<<6|d,t=a>>16&255,o=a>>8&255,n=a&255,s===64?C[m++]=String.fromCharCode(t):d===64?C[m++]=String.fromCharCode(t,o):C[m++]=String.fromCharCode(t,o,n);while(p<e.length);return b=C.join(""),Xr(b)}function gt(e){return e=$r(e),e.replace(/\//g,"_").replace(/\+/g,"-")}function Br(e){return e=e.replace(/_/g,"/").replace(/-/g,"+"),jr(e)}var vt={exports:{}};(function(e,r){(function(t){e.exports=t()})(function(t){var o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(g,v){var u=g[0],c=g[1],h=g[2],f=g[3];u+=(c&h|~c&f)+v[0]-680876936|0,u=(u<<7|u>>>25)+c|0,f+=(u&c|~u&h)+v[1]-389564586|0,f=(f<<12|f>>>20)+u|0,h+=(f&u|~f&c)+v[2]+606105819|0,h=(h<<17|h>>>15)+f|0,c+=(h&f|~h&u)+v[3]-1044525330|0,c=(c<<22|c>>>10)+h|0,u+=(c&h|~c&f)+v[4]-176418897|0,u=(u<<7|u>>>25)+c|0,f+=(u&c|~u&h)+v[5]+1200080426|0,f=(f<<12|f>>>20)+u|0,h+=(f&u|~f&c)+v[6]-1473231341|0,h=(h<<17|h>>>15)+f|0,c+=(h&f|~h&u)+v[7]-45705983|0,c=(c<<22|c>>>10)+h|0,u+=(c&h|~c&f)+v[8]+1770035416|0,u=(u<<7|u>>>25)+c|0,f+=(u&c|~u&h)+v[9]-1958414417|0,f=(f<<12|f>>>20)+u|0,h+=(f&u|~f&c)+v[10]-42063|0,h=(h<<17|h>>>15)+f|0,c+=(h&f|~h&u)+v[11]-1990404162|0,c=(c<<22|c>>>10)+h|0,u+=(c&h|~c&f)+v[12]+1804603682|0,u=(u<<7|u>>>25)+c|0,f+=(u&c|~u&h)+v[13]-40341101|0,f=(f<<12|f>>>20)+u|0,h+=(f&u|~f&c)+v[14]-1502002290|0,h=(h<<17|h>>>15)+f|0,c+=(h&f|~h&u)+v[15]+1236535329|0,c=(c<<22|c>>>10)+h|0,u+=(c&f|h&~f)+v[1]-165796510|0,u=(u<<5|u>>>27)+c|0,f+=(u&h|c&~h)+v[6]-1069501632|0,f=(f<<9|f>>>23)+u|0,h+=(f&c|u&~c)+v[11]+643717713|0,h=(h<<14|h>>>18)+f|0,c+=(h&u|f&~u)+v[0]-373897302|0,c=(c<<20|c>>>12)+h|0,u+=(c&f|h&~f)+v[5]-701558691|0,u=(u<<5|u>>>27)+c|0,f+=(u&h|c&~h)+v[10]+38016083|0,f=(f<<9|f>>>23)+u|0,h+=(f&c|u&~c)+v[15]-660478335|0,h=(h<<14|h>>>18)+f|0,c+=(h&u|f&~u)+v[4]-405537848|0,c=(c<<20|c>>>12)+h|0,u+=(c&f|h&~f)+v[9]+568446438|0,u=(u<<5|u>>>27)+c|0,f+=(u&h|c&~h)+v[14]-1019803690|0,f=(f<<9|f>>>23)+u|0,h+=(f&c|u&~c)+v[3]-187363961|0,h=(h<<14|h>>>18)+f|0,c+=(h&u|f&~u)+v[8]+1163531501|0,c=(c<<20|c>>>12)+h|0,u+=(c&f|h&~f)+v[13]-1444681467|0,u=(u<<5|u>>>27)+c|0,f+=(u&h|c&~h)+v[2]-51403784|0,f=(f<<9|f>>>23)+u|0,h+=(f&c|u&~c)+v[7]+1735328473|0,h=(h<<14|h>>>18)+f|0,c+=(h&u|f&~u)+v[12]-1926607734|0,c=(c<<20|c>>>12)+h|0,u+=(c^h^f)+v[5]-378558|0,u=(u<<4|u>>>28)+c|0,f+=(u^c^h)+v[8]-2022574463|0,f=(f<<11|f>>>21)+u|0,h+=(f^u^c)+v[11]+1839030562|0,h=(h<<16|h>>>16)+f|0,c+=(h^f^u)+v[14]-35309556|0,c=(c<<23|c>>>9)+h|0,u+=(c^h^f)+v[1]-1530992060|0,u=(u<<4|u>>>28)+c|0,f+=(u^c^h)+v[4]+1272893353|0,f=(f<<11|f>>>21)+u|0,h+=(f^u^c)+v[7]-155497632|0,h=(h<<16|h>>>16)+f|0,c+=(h^f^u)+v[10]-1094730640|0,c=(c<<23|c>>>9)+h|0,u+=(c^h^f)+v[13]+681279174|0,u=(u<<4|u>>>28)+c|0,f+=(u^c^h)+v[0]-358537222|0,f=(f<<11|f>>>21)+u|0,h+=(f^u^c)+v[3]-722521979|0,h=(h<<16|h>>>16)+f|0,c+=(h^f^u)+v[6]+76029189|0,c=(c<<23|c>>>9)+h|0,u+=(c^h^f)+v[9]-640364487|0,u=(u<<4|u>>>28)+c|0,f+=(u^c^h)+v[12]-421815835|0,f=(f<<11|f>>>21)+u|0,h+=(f^u^c)+v[15]+530742520|0,h=(h<<16|h>>>16)+f|0,c+=(h^f^u)+v[2]-995338651|0,c=(c<<23|c>>>9)+h|0,u+=(h^(c|~f))+v[0]-198630844|0,u=(u<<6|u>>>26)+c|0,f+=(c^(u|~h))+v[7]+1126891415|0,f=(f<<10|f>>>22)+u|0,h+=(u^(f|~c))+v[14]-1416354905|0,h=(h<<15|h>>>17)+f|0,c+=(f^(h|~u))+v[5]-57434055|0,c=(c<<21|c>>>11)+h|0,u+=(h^(c|~f))+v[12]+1700485571|0,u=(u<<6|u>>>26)+c|0,f+=(c^(u|~h))+v[3]-1894986606|0,f=(f<<10|f>>>22)+u|0,h+=(u^(f|~c))+v[10]-1051523|0,h=(h<<15|h>>>17)+f|0,c+=(f^(h|~u))+v[1]-2054922799|0,c=(c<<21|c>>>11)+h|0,u+=(h^(c|~f))+v[8]+1873313359|0,u=(u<<6|u>>>26)+c|0,f+=(c^(u|~h))+v[15]-30611744|0,f=(f<<10|f>>>22)+u|0,h+=(u^(f|~c))+v[6]-1560198380|0,h=(h<<15|h>>>17)+f|0,c+=(f^(h|~u))+v[13]+1309151649|0,c=(c<<21|c>>>11)+h|0,u+=(h^(c|~f))+v[4]-145523070|0,u=(u<<6|u>>>26)+c|0,f+=(c^(u|~h))+v[11]-1120210379|0,f=(f<<10|f>>>22)+u|0,h+=(u^(f|~c))+v[2]+718787259|0,h=(h<<15|h>>>17)+f|0,c+=(f^(h|~u))+v[9]-343485551|0,c=(c<<21|c>>>11)+h|0,g[0]=u+g[0]|0,g[1]=c+g[1]|0,g[2]=h+g[2]|0,g[3]=f+g[3]|0}function i(g){var v=[],u;for(u=0;u<64;u+=4)v[u>>2]=g.charCodeAt(u)+(g.charCodeAt(u+1)<<8)+(g.charCodeAt(u+2)<<16)+(g.charCodeAt(u+3)<<24);return v}function l(g){var v=[],u;for(u=0;u<64;u+=4)v[u>>2]=g[u]+(g[u+1]<<8)+(g[u+2]<<16)+(g[u+3]<<24);return v}function s(g){var v=g.length,u=[1732584193,-271733879,-1732584194,271733878],c,h,f,M,F,X;for(c=64;c<=v;c+=64)n(u,i(g.substring(c-64,c)));for(g=g.substring(c-64),h=g.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0;c<h;c+=1)f[c>>2]|=g.charCodeAt(c)<<(c%4<<3);if(f[c>>2]|=128<<(c%4<<3),c>55)for(n(u,f),c=0;c<16;c+=1)f[c]=0;return M=v*8,M=M.toString(16).match(/(.*?)(.{0,8})$/),F=parseInt(M[2],16),X=parseInt(M[1],16)||0,f[14]=F,f[15]=X,n(u,f),u}function d(g){var v=g.length,u=[1732584193,-271733879,-1732584194,271733878],c,h,f,M,F,X;for(c=64;c<=v;c+=64)n(u,l(g.subarray(c-64,c)));for(g=c-64<v?g.subarray(c-64):new Uint8Array(0),h=g.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0;c<h;c+=1)f[c>>2]|=g[c]<<(c%4<<3);if(f[c>>2]|=128<<(c%4<<3),c>55)for(n(u,f),c=0;c<16;c+=1)f[c]=0;return M=v*8,M=M.toString(16).match(/(.*?)(.{0,8})$/),F=parseInt(M[2],16),X=parseInt(M[1],16)||0,f[14]=F,f[15]=X,n(u,f),u}function a(g){var v="",u;for(u=0;u<4;u+=1)v+=o[g>>u*8+4&15]+o[g>>u*8&15];return v}function p(g){var v;for(v=0;v<g.length;v+=1)g[v]=a(g[v]);return g.join("")}p(s("hello")),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function g(v,u){return v=v|0||0,v<0?Math.max(v+u,0):Math.min(v,u)}ArrayBuffer.prototype.slice=function(v,u){var c=this.byteLength,h=g(v,c),f=c,M,F,X,H;return u!==t&&(f=g(u,c)),h>f?new ArrayBuffer(0):(M=f-h,F=new ArrayBuffer(M),X=new Uint8Array(F),H=new Uint8Array(this,h,M),X.set(H),F)}}();function m(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function b(g,v){var u=g.length,c=new ArrayBuffer(u),h=new Uint8Array(c),f;for(f=0;f<u;f+=1)h[f]=g.charCodeAt(f);return v?h:c}function C(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function x(g,v,u){var c=new Uint8Array(g.byteLength+v.byteLength);return c.set(new Uint8Array(g)),c.set(new Uint8Array(v),g.byteLength),u?c:c.buffer}function w(g){var v=[],u=g.length,c;for(c=0;c<u-1;c+=2)v.push(parseInt(g.substr(c,2),16));return String.fromCharCode.apply(String,v)}function y(){this.reset()}return y.prototype.append=function(g){return this.appendBinary(m(g)),this},y.prototype.appendBinary=function(g){this._buff+=g,this._length+=g.length;var v=this._buff.length,u;for(u=64;u<=v;u+=64)n(this._hash,i(this._buff.substring(u-64,u)));return this._buff=this._buff.substring(u-64),this},y.prototype.end=function(g){var v=this._buff,u=v.length,c,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f;for(c=0;c<u;c+=1)h[c>>2]|=v.charCodeAt(c)<<(c%4<<3);return this._finish(h,u),f=p(this._hash),g&&(f=w(f)),this.reset(),f},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},y.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(g,v){var u=v,c,h,f;if(g[u>>2]|=128<<(u%4<<3),u>55)for(n(this._hash,g),u=0;u<16;u+=1)g[u]=0;c=this._length*8,c=c.toString(16).match(/(.*?)(.{0,8})$/),h=parseInt(c[2],16),f=parseInt(c[1],16)||0,g[14]=h,g[15]=f,n(this._hash,g)},y.hash=function(g,v){return y.hashBinary(m(g),v)},y.hashBinary=function(g,v){var u=s(g),c=p(u);return v?w(c):c},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(g){var v=x(this._buff.buffer,g,!0),u=v.length,c;for(this._length+=g.byteLength,c=64;c<=u;c+=64)n(this._hash,l(v.subarray(c-64,c)));return this._buff=c-64<u?new Uint8Array(v.buffer.slice(c-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(g){var v=this._buff,u=v.length,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h,f;for(h=0;h<u;h+=1)c[h>>2]|=v[h]<<(h%4<<3);return this._finish(c,u),f=p(this._hash),g&&(f=w(f)),this.reset(),f},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var g=y.prototype.getState.call(this);return g.buff=C(g.buff),g},y.ArrayBuffer.prototype.setState=function(g){return g.buff=b(g.buff,!0),y.prototype.setState.call(this,g)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(g,v){var u=d(new Uint8Array(g)),c=p(u);return v?w(c):c},y})})(vt);var Yr=vt.exports,me=globalThis&&globalThis.__assign||function(){return me=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},me.apply(this,arguments)},Rr=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},Wr=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},q=Math.pow(1024,2);function Nr(e,r){var t=r*q;if(t>e.size)t=e.size;else for(;e.size>t*1e4;)t*=2;for(var o=[],n=Math.ceil(e.size/t),i=0;i<n;i++){var l=e.slice(t*i,i===n-1?e.size:t*(i+1));o.push(l)}return o}function Dr(e){return Object.keys(e).every(function(r){return r.indexOf("x-qn-meta-")===0})}function qr(e){return Object.keys(e).every(function(r){return r.indexOf("x:")===0})}function Vr(e){return e.reduce(function(r,t){return r+t},0)}function Gr(e,r,t){try{localStorage.setItem(e,JSON.stringify(r))}catch{t.warn(new P(L.WriteCacheFailed,"setLocalFileInfo failed: "+e))}}function Jr(e,r,t){var o=r==null?"_":"_key_"+r+"_";return"qiniu_js_sdk_upload_file_name_"+e+o+"size_"+t}function Oe(e,r){try{localStorage.removeItem(e)}catch{r.warn(new P(L.RemoveCacheFailed,"removeLocalFileInfo failed. key: "+e))}}function Zr(e,r){var t=null;try{t=localStorage.getItem(e)}catch{r.warn(new P(L.ReadCacheFailed,"getLocalFileInfo failed. key: "+e))}if(t==null)return null;var o=null;try{o=JSON.parse(t)}catch{Oe(e,r),r.warn(new P(L.InvalidCacheData,"getLocalFileInfo failed to parse. key: "+e))}return o}function xe(e){var r="UpToken "+e;return{Authorization:r}}function Kr(e){var r=xe(e);return me({"content-type":"application/octet-stream"},r)}function Qr(e){var r=xe(e);return me({"content-type":"application/json"},r)}function mt(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new window.ActiveXObject("Microsoft.XMLHTTP");throw new P(L.NotAvailableXMLHttpRequest,"the current environment does not support.")}function eo(e){return Rr(this,void 0,void 0,function(){var r,t;return Wr(this,function(o){switch(o.label){case 0:return[4,to(e)];case 1:return r=o.sent(),t=new Yr.ArrayBuffer,t.append(r),[2,t.end()]}})})}function to(e){return new Promise(function(r,t){var o=new FileReader;o.onload=function(n){if(n.target){var i=n.target.result;r(i)}else t(new P(L.InvalidProgressEventTarget,"progress event target is undefined"))},o.onerror=function(){t(new P(L.FileReaderReadFailed,"fileReader read failed"))},o.readAsArrayBuffer(e)})}function ne(e,r){return new Promise(function(t,o){var n=mt();if(n.open(r.method,e),r.onCreate&&r.onCreate(n),r.headers){var i=r.headers;Object.keys(i).forEach(function(l){n.setRequestHeader(l,i[l])})}n.upload.addEventListener("progress",function(l){l.lengthComputable&&r.onProgress&&r.onProgress({loaded:l.loaded,total:l.total})}),n.onreadystatechange=function(){var l=n.responseText;if(n.readyState===4){var s=n.getResponseHeader("x-reqId")||"";if(n.status===0){o(new Er("network error.",s));return}if(n.status!==200){var d="xhr request failed, code: "+n.status;l&&(d+=" response: "+l);var a=void 0;try{a=JSON.parse(l)}catch{}o(new ie(n.status,s,d,a));return}try{t({data:JSON.parse(l),reqId:s})}catch(p){o(p)}}},n.send(r.body)})}function ro(e){if(e&&e.match){var r=e.match(/(^https?)/);if(!r)return"";var t=r[1];return r=e.match(/^https?:\/\/([^:^/]*):(\d*)/),r?r[2]:t==="http"?"80":"443"}return""}function oo(e){if(e&&e.match){var r=e.match(/^https?:\/\/([^:^/]*)/);return r?r[1]:""}return""}function Le(e){if(!e)throw new P(L.InvalidToken,"invalid token.");var r=e.split(":");if(r.length===1)throw new P(L.InvalidToken,"invalid token segments.");var t=r.length>3?r[1]:r[0];if(!t)throw new P(L.InvalidToken,"missing assess key field.");var o=null;try{o=JSON.parse(Br(r[r.length-1]))}catch{throw new P(L.InvalidToken,"token parse failed.")}if(o==null)throw new P(L.InvalidToken,"putPolicy is null.");if(o.scope==null)throw new P(L.InvalidToken,"scope field is null.");var n=o.scope.split(":")[0];if(!n)throw new P(L.InvalidToken,"resolve bucketName failed.");return{assessKey:t,bucketName:n,scope:o.scope}}var R,N={z0:"z0",z1:"z1",z2:"z2",na0:"na0",as0:"as0",cnEast2:"cn-east-2"},io=(R={},R[N.z0]={srcUphost:["up.qiniup.com"],cdnUphost:["upload.qiniup.com"]},R[N.z1]={srcUphost:["up-z1.qiniup.com"],cdnUphost:["upload-z1.qiniup.com"]},R[N.z2]={srcUphost:["up-z2.qiniup.com"],cdnUphost:["upload-z2.qiniup.com"]},R[N.na0]={srcUphost:["up-na0.qiniup.com"],cdnUphost:["upload-na0.qiniup.com"]},R[N.as0]={srcUphost:["up-as0.qiniup.com"],cdnUphost:["upload-as0.qiniup.com"]},R[N.cnEast2]={srcUphost:["up-cn-east-2.qiniup.com"],cdnUphost:["upload-cn-east-2.qiniup.com"]},R),Q=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},no=function(e,r,t,o){return r=r||"&",t=t||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(n){var i=encodeURIComponent(Q(n))+t;return Array.isArray(e[n])?e[n].map(function(l){return i+encodeURIComponent(Q(l))}).join(r):i+encodeURIComponent(Q(e[n]))}).filter(Boolean).join(r):o?encodeURIComponent(Q(o))+t+encodeURIComponent(Q(e)):""},bt;bt=no;var D=globalThis&&globalThis.__assign||function(){return D=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D.apply(this,arguments)},ao=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},lo=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};function so(e,r,t){return ao(this,void 0,void 0,function(){var o,n;return lo(this,function(i){return o=bt({ak:e,bucket:r}),n=t+"://api.qiniu.com/v2/query?"+o,[2,ne(n,{method:"GET"})]})})}function yt(e,r,t){var o=t.url,n=t.id;return o+"/buckets/"+e+"/objects/"+(r!=null?gt(r):"~")+"/uploads/"+n}function co(e,r,t,o){var n=o+"/buckets/"+r+"/objects/"+(t!=null?gt(t):"~")+"/uploads";return ne(n,{method:"POST",headers:xe(e)})}function uo(e,r,t,o,n){var i=Le(e).bucketName,l=yt(i,r,o)+("/"+t),s=Kr(e);return n.md5&&(s["Content-MD5"]=n.md5),ne(l,D(D({},n),{method:"PUT",headers:s}))}function po(e,r,t,o){var n=Le(e).bucketName,i=yt(n,r,t);return ne(i,D(D({},o),{method:"POST",headers:Qr(e)}))}function ho(e,r,t){return ne(e,D({method:"POST",body:r},t))}var be=globalThis&&globalThis.__assign||function(){return be=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},be.apply(this,arguments)},Ne=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},De=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},fo=globalThis&&globalThis.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),n,i=[],l;try{for(;(r===void 0||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(s){l={error:s}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(l)throw l.error}}return i},go=globalThis&&globalThis.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(fo(arguments[r]));return e},vo=4,xt=[0,502,503,504,599],mo=go(xt,[612]),bo=Math.pow(1024,3),wt=function(){function e(r,t,o,n){this.hostPool=o,this.logger=n,this.aborted=!1,this.retryCount=0,this.xhrList=[],this.config=r.config,n.info("config inited.",this.config),this.putExtra=be({fname:""},r.putExtra),n.info("putExtra inited.",this.putExtra),this.key=r.key,this.file=r.file,this.token=r.token,this.onData=t.onData,this.onError=t.onError,this.onComplete=t.onComplete;try{var i=Le(this.token);this.bucketName=i.bucketName,this.assessKey=i.assessKey}catch(l){n.error("get putPolicy from token failed.",l),this.onError(l)}}return e.prototype.checkAndUpdateUploadHost=function(){return Ne(this,void 0,void 0,function(){var r;return De(this,function(t){switch(t.label){case 0:return this.logger.info("get available upload host."),[4,this.hostPool.getUp(this.assessKey,this.bucketName,this.config.upprotocol)];case 1:if(r=t.sent(),r==null)throw new P(L.NotAvailableUploadHost,"no available upload host.");return this.uploadHost!=null&&this.uploadHost.host!==r.host?this.logger.warn("host switches from "+this.uploadHost.host+" to "+r.host+"."):this.logger.info("use host "+r.host+"."),this.uploadHost=r,[2]}})})},e.prototype.checkAndUnfreezeHost=function(){this.logger.info("check unfreeze host."),this.uploadHost!=null&&this.uploadHost.isFrozen()&&(this.logger.warn(this.uploadHost.host+" will be unfrozen."),this.uploadHost.unfreeze())},e.prototype.checkAndFreezeHost=function(r){this.logger.info("check freeze host."),r instanceof ie&&this.uploadHost!=null&&xt.includes(r.code)&&(this.logger.warn(this.uploadHost.host+" will be temporarily frozen."),this.uploadHost.freeze())},e.prototype.handleError=function(r){this.logger.error(r.message),this.onError(r)},e.prototype.putFile=function(){return Ne(this,void 0,void 0,function(){var r,t,o,n,i,l;return De(this,function(s){switch(s.label){case 0:if(this.aborted=!1,this.putExtra.fname||(this.logger.info("use file.name as fname."),this.putExtra.fname=this.file.name),this.file.size>1e4*bo)return this.handleError(new P(L.InvalidFile,"file size exceed maximum value 10000G")),[2];if(this.putExtra.customVars&&!qr(this.putExtra.customVars))return this.handleError(new P(L.InvalidCustomVars,"customVars key should start width x:")),[2];if(this.putExtra.metadata&&!Dr(this.putExtra.metadata))return this.handleError(new P(L.InvalidMetadata,"metadata key should start with x-qn-meta-")),[2];s.label=1;case 1:return s.trys.push([1,4,,5]),this.uploadAt=new Date().getTime(),[4,this.checkAndUpdateUploadHost()];case 2:return s.sent(),[4,this.run()];case 3:return r=s.sent(),this.onComplete(r.data),this.checkAndUnfreezeHost(),this.sendLog(r.reqId,200),[2];case 4:return t=s.sent(),this.logger.error(t),this.clear(),t instanceof ie&&(o=this.aborted?"":t.reqId,n=this.aborted?-2:t.code,this.sendLog(o,n),this.checkAndFreezeHost(t),i=++this.retryCount<=this.config.retryCount,l=!this.aborted&&mo.includes(t.code),l&&i)?(this.logger.warn("error auto retry: "+this.retryCount+"/"+this.config.retryCount+"."),this.putFile(),[2]):(this.onError(t),[3,5]);case 5:return[2]}})})},e.prototype.clear=function(){this.logger.info("start cleaning all xhr."),this.xhrList.forEach(function(r){r.onreadystatechange=null,r.abort()}),this.logger.info("cleanup completed."),this.xhrList=[]},e.prototype.stop=function(){this.logger.info("stop."),this.clear(),this.aborted=!0},e.prototype.addXhr=function(r){this.xhrList.push(r)},e.prototype.sendLog=function(r,t){var o,n;this.logger.report({code:t,reqId:r,remoteIp:"",upType:"jssdk-h5",size:this.file.size,time:Math.floor(this.uploadAt/1e3),port:ro((o=this.uploadHost)===null||o===void 0?void 0:o.getUrl()),host:oo((n=this.uploadHost)===null||n===void 0?void 0:n.getUrl()),bytesSent:this.progress?this.progress.total.loaded:0,duration:Math.floor((new Date().getTime()-this.uploadAt)/1e3)})},e.prototype.getProgressInfoItem=function(r,t,o){return be({size:t,loaded:r,percent:r/t*100},o==null?{}:{fromCache:o})},e}(),yo=globalThis&&globalThis.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i])},e(r,t)};return function(r,t){e(r,t);function o(){this.constructor=r}r.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),re=globalThis&&globalThis.__assign||function(){return re=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},re.apply(this,arguments)},de=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},he=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};function xo(e){var r=/^[1-9]\d*$/;return r.test(String(e))}var wo=function(e){yo(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.run=function(){return de(this,void 0,void 0,function(){var t,o,n,i,l,s=this;return he(this,function(d){switch(d.label){case 0:if(this.logger.info("start run Resume."),!this.config.chunkSize||!xo(this.config.chunkSize))throw new P(L.InvalidChunkSize,"chunkSize must be a positive integer");if(this.config.chunkSize>1024)throw new P(L.InvalidChunkSize,"chunkSize maximum value is 1024");return[4,this.initBeforeUploadChunks()];case 1:d.sent(),t=new Mr(function(a){return s.uploadChunk(a)},this.config.concurrentRequestLimit),o=null,n=this.getLocalKey(),i=this.chunks.map(function(a,p){return t.enqueue({chunk:a,index:p})}),d.label=2;case 2:return d.trys.push([2,5,,6]),[4,Promise.all(i)];case 3:return d.sent(),[4,this.mkFileReq()];case 4:return o=d.sent(),[3,6];case 5:throw l=d.sent(),l instanceof ie&&(l.code===612||l.code===400)&&Oe(n,this.logger),l;case 6:return Oe(n,this.logger),[2,o]}})})},r.prototype.uploadChunk=function(t){return de(this,void 0,void 0,function(){var o,n,i,l,s,d,a,p,m,b=this;return he(this,function(C){switch(C.label){case 0:return o=t.index,n=t.chunk,i=this.cachedUploadedList[o],this.logger.info("upload part "+o+", cache:",i),l=this.config.checkByMD5,s=function(){b.usedCacheList[o]=!0,b.updateChunkProgress(n.size,o),b.uploadedList[o]=i,b.updateLocalCache()},i&&!l?(s(),[2]):[4,eo(n)];case 1:return d=C.sent(),this.logger.info("computed part md5.",d),i&&d===i.md5?(s(),[2]):(this.usedCacheList[o]=!1,a=function(x){b.updateChunkProgress(x.loaded,o)},p={body:n,md5:this.config.checkByServer?d:void 0,onProgress:a,onCreate:function(x){return b.addXhr(x)}},this.logger.info("part "+o+" start uploading."),[4,uo(this.token,this.key,t.index+1,this.getUploadInfo(),p)]);case 2:return m=C.sent(),this.logger.info("part "+o+" upload completed."),a({loaded:n.size,total:n.size}),this.uploadedList[o]={etag:m.data.etag,md5:m.data.md5,size:n.size},this.updateLocalCache(),[2]}})})},r.prototype.mkFileReq=function(){return de(this,void 0,void 0,function(){var t,o,n=this;return he(this,function(i){switch(i.label){case 0:return t=re(re(re({parts:this.uploadedList.map(function(l,s){return{etag:l.etag,partNumber:s+1}}),fname:this.putExtra.fname},this.putExtra.mimeType&&{mimeType:this.putExtra.mimeType}),this.putExtra.customVars&&{customVars:this.putExtra.customVars}),this.putExtra.metadata&&{metadata:this.putExtra.metadata}),this.logger.info("parts upload completed, make file.",t),[4,po(this.token,this.key,this.getUploadInfo(),{onCreate:function(l){return n.addXhr(l)},body:JSON.stringify(t)})];case 1:return o=i.sent(),this.logger.info("finish Resume Progress."),this.updateMkFileProgress(1),[2,o]}})})},r.prototype.initBeforeUploadChunks=function(){return de(this,void 0,void 0,function(){var t,o,n;return he(this,function(i){switch(i.label){case 0:return this.uploadedList=[],this.usedCacheList=[],t=Zr(this.getLocalKey(),this.logger),t?[3,2]:(this.logger.info("init upload parts from api."),[4,co(this.token,this.bucketName,this.key,this.uploadHost.getUrl())]);case 1:return o=i.sent(),this.logger.info("initd upload parts of id: "+o.data.uploadId+"."),this.uploadId=o.data.uploadId,this.cachedUploadedList=[],[3,3];case 2:n=["resume upload parts from local cache,","total "+t.data.length+" part,","id is "+t.id+"."],this.logger.info(n.join(" ")),this.cachedUploadedList=t.data,this.uploadId=t.id,i.label=3;case 3:return this.chunks=Nr(this.file,this.config.chunkSize),this.loaded={mkFileProgress:0,chunks:this.chunks.map(function(l){return 0})},this.notifyResumeProgress(),[2]}})})},r.prototype.getUploadInfo=function(){return{id:this.uploadId,url:this.uploadHost.getUrl()}},r.prototype.getLocalKey=function(){return Jr(this.file.name,this.key,this.file.size)},r.prototype.updateLocalCache=function(){Gr(this.getLocalKey(),{id:this.uploadId,data:this.uploadedList},this.logger)},r.prototype.updateChunkProgress=function(t,o){this.loaded.chunks[o]=t,this.notifyResumeProgress()},r.prototype.updateMkFileProgress=function(t){this.loaded.mkFileProgress=t,this.notifyResumeProgress()},r.prototype.notifyResumeProgress=function(){var t=this;this.progress={total:this.getProgressInfoItem(Vr(this.loaded.chunks)+this.loaded.mkFileProgress,this.file.size+1),chunks:this.chunks.map(function(o,n){var i=t.usedCacheList[n];return t.getProgressInfoItem(t.loaded.chunks[n],o.size,i)}),uploadInfo:{id:this.uploadId,url:this.uploadHost.getUrl()}},this.onData(this.progress)},r}(wt),qe=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},Ve=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},_o=function(){function e(){this.crc=-1,this.table=this.makeTable()}return e.prototype.makeTable=function(){for(var r=new Array,t=0;t<256;t++){for(var o=t,n=0;n<8;n++)o&1?o=o>>>1^3988292384:o>>>=1;r[t]=o}return r},e.prototype.append=function(r){for(var t=this.crc,o=0;o<r.byteLength;o++)t=t>>>8^this.table[(t^r[o])&255];this.crc=t},e.prototype.compute=function(){return(this.crc^-1)>>>0},e.prototype.readAsUint8Array=function(r){return qe(this,void 0,void 0,function(){var t;return Ve(this,function(o){switch(o.label){case 0:return typeof r.arrayBuffer!="function"?[3,2]:(t=Uint8Array.bind,[4,r.arrayBuffer()]);case 1:return[2,new(t.apply(Uint8Array,[void 0,o.sent()]))];case 2:return[2,new Promise(function(n,i){var l=new FileReader;l.onload=function(){if(l.result==null){i();return}if(typeof l.result=="string"){i();return}n(new Uint8Array(l.result))},l.readAsArrayBuffer(r)})]}})})},e.prototype.file=function(r){return qe(this,void 0,void 0,function(){var t,o,n,i,l,s;return Ve(this,function(d){switch(d.label){case 0:return r.size<=q?(t=this.append,[4,this.readAsUint8Array(r)]):[3,2];case 1:return t.apply(this,[d.sent()]),[2,this.compute()];case 2:o=Math.ceil(r.size/q),n=0,d.label=3;case 3:return n<o?(i=n*q,l=n===o-1?r.size:i+q,[4,this.readAsUint8Array(r.slice(i,l))]):[3,6];case 4:s=d.sent(),this.append(new Uint8Array(s)),d.label=5;case 5:return n++,[3,3];case 6:return[2,this.compute()]}})})},e.file=function(r){var t=new e;return t.file(r)},e}(),Co=globalThis&&globalThis.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i])},e(r,t)};return function(r,t){e(r,t);function o(){this.constructor=r}r.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),ko=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},So=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ge=function(e){Co(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.run=function(){return ko(this,void 0,void 0,function(){var t,o,n,i,l=this;return So(this,function(s){switch(s.label){case 0:return this.logger.info("start run Direct."),t=new FormData,t.append("file",this.file),t.append("token",this.token),this.key!=null&&t.append("key",this.key),t.append("fname",this.putExtra.fname),this.config.checkByServer?[4,_o.file(this.file)]:[3,2];case 1:o=s.sent(),t.append("crc32",o.toString()),s.label=2;case 2:return this.putExtra.customVars&&(this.logger.info("init customVars."),n=this.putExtra.customVars,Object.keys(n).forEach(function(d){return t.append(d,n[d].toString())}),this.logger.info("customVars inited.")),this.logger.info("formData inited."),[4,ho(this.uploadHost.getUrl(),t,{onProgress:function(d){l.updateDirectProgress(d.loaded,d.total)},onCreate:function(d){return l.addXhr(d)}})];case 3:return i=s.sent(),this.logger.info("Direct progress finish."),this.finishDirectProgress(),[2,i]}})})},r.prototype.updateDirectProgress=function(t,o){this.progress={total:this.getProgressInfoItem(t,o+1)},this.onData(this.progress)},r.prototype.finishDirectProgress=function(){if(!this.progress){this.logger.warn("progress is null."),this.progress={total:this.getProgressInfoItem(this.file.size,this.file.size)},this.onData(this.progress);return}var t=this.progress.total;this.progress={total:this.getProgressInfoItem(t.loaded+1,t.size)},this.onData(this.progress)},r}(wt);function _t(e,r,t){t===void 0&&(t=3);var o=mt();o.open("POST","https://uplog.qbox.me/log/3"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.setRequestHeader("Authorization",xe(e).Authorization),o.onreadystatechange=function(){o.readyState===4&&o.status!==200&&t>0&&_t(e,r,t-1)};var n=[r.code||"",r.reqId||"",r.host||"",r.remoteIp||"",r.port||"",r.duration||"",r.time||"",r.bytesSent||"",r.upType||"",r.size||""].join(",");o.send(n)}var zo=globalThis&&globalThis.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),n,i=[],l;try{for(;(r===void 0||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(s){l={error:s}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(l)throw l.error}}return i},ze=globalThis&&globalThis.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(zo(arguments[r]));return e},Ao=function(){function e(r,t,o,n){t===void 0&&(t=!0),o===void 0&&(o="OFF"),n===void 0&&(n="UPLOAD"),this.token=r,this.disableReport=t,this.level=o,this.prefix=n,this.id=++e.id}return e.prototype.getPrintPrefix=function(r){return"Qiniu-JS-SDK ["+r+"]["+this.prefix+"#"+this.id+"]:"},e.prototype.report=function(r,t){if(!this.disableReport)try{_t(this.token,r,t)}catch(o){this.warn(o)}},e.prototype.info=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var o=["INFO"];o.includes(this.level)&&console.log.apply(console,ze([this.getPrintPrefix("INFO")],r))},e.prototype.warn=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var o=["INFO","WARN"];o.includes(this.level)&&console.warn.apply(console,ze([this.getPrintPrefix("WARN")],r))},e.prototype.error=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var o=["INFO","WARN","ERROR"];o.includes(this.level)&&console.error.apply(console,ze([this.getPrintPrefix("ERROR")],r))},e.id=0,e}(),Je=globalThis&&globalThis.__awaiter||function(e,r,t,o){function n(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function s(p){try{a(o.next(p))}catch(m){l(m)}}function d(p){try{a(o.throw(p))}catch(m){l(m)}}function a(p){p.done?i(p.value):n(p.value).then(s,d)}a((o=o.apply(e,r||[])).next())})},Ze=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,n,i,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(p){return d([a,p])}}function d(a){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,n&&(i=a[0]&2?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,n=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=r.call(e,t)}catch(p){a=[6,p],n=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Oo=globalThis&&globalThis.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),n,i=[],l;try{for(;(r===void 0||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(s){l={error:s}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(l)throw l.error}}return i},To=globalThis&&globalThis.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(Oo(arguments[r]));return e},fe=new Map,Io=function(){function e(r,t){this.host=r,this.protocol=t}return e.prototype.isFrozen=function(){var r=new Date().getTime(),t=fe.get(this.host);return t!=null&&t>=r},e.prototype.freeze=function(r){r===void 0&&(r=20);var t=new Date().getTime()+r*1e3;fe.set(this.host,t)},e.prototype.unfreeze=function(){fe.delete(this.host)},e.prototype.getUrl=function(){return this.protocol+"://"+this.host},e.prototype.getUnfreezeTime=function(){return fe.get(this.host)},e}(),Eo=function(){function e(r){r===void 0&&(r=[]),this.initHosts=r,this.cachedHostsMap=new Map}return e.prototype.register=function(r,t,o,n){this.cachedHostsMap.set(r+"@"+t,o.map(function(i){return new Io(i,n)}))},e.prototype.refresh=function(r,t,o){var n,i,l,s;return Je(this,void 0,void 0,function(){var d,a,p;return Ze(this,function(m){switch(m.label){case 0:return d=this.cachedHostsMap.get(r+"@"+t)||[],d.length>0?[2]:this.initHosts.length>0?(this.register(r,t,this.initHosts,o),[2]):[4,so(r,t,o)];case 1:return a=m.sent(),(a==null?void 0:a.data)!=null&&(p=To(((i=(n=a.data.up)===null||n===void 0?void 0:n.acc)===null||i===void 0?void 0:i.main)||[],((s=(l=a.data.up)===null||l===void 0?void 0:l.acc)===null||s===void 0?void 0:s.backup)||[]),this.register(r,t,p,o)),[2]}})})},e.prototype.getUp=function(r,t,o){return Je(this,void 0,void 0,function(){var n,i,l;return Ze(this,function(s){switch(s.label){case 0:return[4,this.refresh(r,t,o)];case 1:return s.sent(),n=this.cachedHostsMap.get(r+"@"+t)||[],n.length===0?[2,null]:(i=n.filter(function(d){return!d.isFrozen()}),i.length>0?[2,i[0]]:(l=n.slice().sort(function(d,a){return(d.getUnfreezeTime()||0)-(a.getUnfreezeTime()||0)}),[2,l[0]]))}})})},e}();function Mo(e,r,t,o){return e.config&&e.config.forceDirect?(o.info("ues forceDirect mode."),new Ge(e,r,t,o)):e.file.size>4*q?(o.info("file size over 4M, use Resume."),new wo(e,r,t,o)):(o.info("file size less or equal than 4M, use Direct."),new Ge(e,r,t,o))}function Ho(e,r,t,o,n){var i=new Ao(t,n==null?void 0:n.disableStatisticsReport,n==null?void 0:n.debugLogLevel,e.name),l={file:e,key:r,token:t,putExtra:o,config:Fo(n,i)},s=new Eo(l.config.uphost);return new Fr(function(d){var a=Mo(l,{onData:function(p){return d.next(p)},onError:function(p){return d.error(p)},onComplete:function(p){return d.complete(p)}},s,i);return a.putFile(),a.stop.bind(a)})}var V=globalThis&&globalThis.__assign||function(){return V=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V.apply(this,arguments)},Lo=globalThis&&globalThis.__rest||function(e,r){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]]);return t},Po=globalThis&&globalThis.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),n,i=[],l;try{for(;(r===void 0||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(s){l={error:s}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(l)throw l.error}}return i},Ae=globalThis&&globalThis.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(Po(arguments[r]));return e};function Fo(e,r){var t=V({},e),o=t.upprotocol,n=t.uphost,i=Lo(t,["upprotocol","uphost"]),l=V({uphost:[],retryCount:3,checkByMD5:!1,forceDirect:!1,useCdnDomain:!0,checkByServer:!1,concurrentRequestLimit:3,chunkSize:vo,upprotocol:"https",debugLogLevel:"OFF",disableStatisticsReport:!1},i);o&&(l.upprotocol=o.replace(/:$/,""));var s=[];if(r&&(e==null?void 0:e.uphost)!=null&&(e==null?void 0:e.region)!=null&&r.warn("do not use both the uphost and region config."),n)Array.isArray(n)?s.push.apply(s,Ae(n)):s.push(n);else if(l!=null&&l.region){var d=io[l==null?void 0:l.region];l.useCdnDomain?s.push.apply(s,Ae(d.cdnUphost)):s.push.apply(s,Ae(d.srcUphost))}return V(V({},l),{uphost:s.filter(Boolean)})}var Ke=globalThis&&globalThis.__assign||function(){return Ke=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ke.apply(this,arguments)};globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var Te={PNG:"image/png",JPEG:"image/jpeg",WEBP:"image/webp",BMP:"image/bmp"};Object.keys(Te).map(function(e){return Te[e]});Te.JPEG;function Uo(){return Vt.get("/public/qiniuToken/")}function Ct(){return{upload:(r,t)=>new Promise((o,n)=>{Uo().then(i=>{let l=i.domain,s=i.token,d=r+"/"+t.name.substring(0,t.name.lastIndexOf("."))+"-"+new Date().getTime()+t.name.substring(t.name.lastIndexOf(".")),a={useCdnDomain:!0,region:N.z1};Ho(t,d,s,{fname:"",params:{},mimeType:null},a).subscribe({next:b=>{console.log(b)},error:b=>{console.log(b),n(b)},complete:b=>{let C=l+b.key;o(C)}})}).catch(i=>{console.log(i)})})}}const kt=e=>(rt("data-v-302b7082"),e=e(),ot(),e),Xo=kt(()=>E("p",null,"\u9009\u62E9\u56FE\u7247",-1)),$o={class:"cropper","element-loading-text":"\u56FE\u7247\u4E0A\u4F20\u4E2D..."},jo={class:"cropper-area"},Bo=kt(()=>E("label",{class:"pointer",for:"uploads"},"\u66F4\u6362\u56FE\u7247",-1)),Yo=J("\u53D6 \u6D88"),Ro=J("\u786E \u5B9A"),Wo={__name:"UploadImgFixed",props:{width:{type:Number,required:!1,default:200},height:{type:Number,required:!1,default:200},dir:{type:String,required:!0,default:"upload"}},emits:["saveImg"],setup(e,{expose:r,emit:t}){const o=e;let{MyIcon:n}=dt(),{timeFile:i}=at(),{upload:l}=Ct();Qe(()=>(console.log(o.width),console.log(o.height),Object.is(o.width,NaN)&&Object.is(o.height,NaN)?o.width/o.height:1));const s=W(null),d=W(""),a=W(!1),p=u=>{let c;"raw"in u?(console.log("element\u5BF9\u8C61"),c=u.raw):(console.log("\u539F\u751F\u5BF9\u8C61"),c=u.target.files[0]);const h=new FileReader;h.onload=f=>{d.value=f.target.result},h.readAsDataURL(c),a.value=!0},m=Ie({}),b=u=>{Object.assign(m,u)},C=u=>{u=u||1,s.value.changeScale(u)},x=u=>{u===1?s.value.rotateLeft():s.value.rotateRight()},w=()=>{s.value.refresh()},y=W(!1),g=()=>{s.value.getCropBlob(u=>{console.log(u),y.value=!0;const c=new File([u],i(Date.now())+".jpg",{type:u.type});console.log(c),l(o.dir,c).then(h=>{console.log(h),oe({message:"\u56FE\u7247\u4E0A\u4F20\u6210\u529F\uFF01",type:"success"}),t("saveImg",h),a.value=!1,y.value=!1}).catch(h=>{console.log(h),oe.error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF01"),y.value=!1})})};return r({test:()=>{console.log("\u8FD9\u662F\u56FE\u7247\u4E0A\u4F20\u7EC4\u4EF6\u7684\u65B9\u6CD5")},uploadChange:p}),(u,c)=>{const h=Ee,f=et,M=it,F=tt,X=nt;return j(),Y("div",null,[_(f,{accept:".jpg,.jpeg,.png",action:"./","auto-upload":!1,"on-change":p,"show-file-list":!1},{default:T(()=>[_(h,{class:"upload-btn",size:"large"},{default:T(()=>[_($(n),{class:"upload-icon",type:"icon-upload-img"}),Xo]),_:1})]),_:1}),_(F,{title:"\u56FE\u7247\u88C1\u526A",modelValue:a.value,"onUpdate:modelValue":c[7]||(c[7]=H=>a.value=H),"append-to-body":"",center:""},{footer:T(()=>[_(h,{size:"medium",type:"success"},{default:T(()=>[Bo]),_:1}),E("input",{type:"file",id:"uploads",style:{position:"absolute",clip:"rect(0 0 0 0)"},accept:"image/png, image/jpeg, image/jpg",onChange:c[0]||(c[0]=H=>p(H))},null,32),_(M,{class:"cropper-btn-group"},{default:T(()=>[_(h,{size:"medium",type:"primary",plain:"",onClick:c[1]||(c[1]=H=>C(1))},{default:T(()=>[_($(n),{type:"icon-amplification"})]),_:1}),_(h,{size:"medium",type:"primary",plain:"",onClick:c[2]||(c[2]=H=>C(-1))},{default:T(()=>[_($(n),{type:"icon-narrow"})]),_:1}),_(h,{size:"medium",type:"primary",plain:"",onClick:c[3]||(c[3]=H=>w())},{default:T(()=>[_($(n),{type:"icon-reset"})]),_:1}),_(h,{size:"medium",type:"primary",plain:"",onClick:c[4]||(c[4]=H=>x(1))},{default:T(()=>[_($(n),{type:"icon-clockwise-sense"})]),_:1}),_(h,{size:"medium",type:"primary",plain:"",onClick:c[5]||(c[5]=H=>x(-1))},{default:T(()=>[_($(n),{type:"icon-clockwise-dirction"})]),_:1})]),_:1}),_(h,{size:"medium",onClick:c[6]||(c[6]=H=>a.value=!1)},{default:T(()=>[Yo]),_:1}),_(h,{type:"primary",onClick:g,size:"medium"},{default:T(()=>[Ro]),_:1})]),default:T(()=>[G((j(),Y("div",$o,[E("span",jo,[_($(He),{ref_key:"cropper",ref:s,img:d.value,autoCrop:!0,autoCropWidth:o.width,autoCropHeight:o.height,fixedNumber:[o.width/o.height,1],fixed:!0,onRealTime:b},null,8,["img","autoCropWidth","autoCropHeight","fixedNumber"])])])),[[X,y.value]])]),_:1},8,["modelValue"])])}}};var No=Me(Wo,[["__scopeId","data-v-302b7082"]]);const St=e=>(rt("data-v-43fcf7c0"),e=e(),ot(),e),Do=St(()=>E("p",null,"\u9009\u62E9\u56FE\u7247",-1)),qo={class:"cropper","element-loading-text":"\u56FE\u7247\u4E0A\u4F20\u4E2D..."},Vo={class:"cropper-area"},Go=St(()=>E("label",{class:"pointer",for:"uploads"},"\u66F4\u6362\u56FE\u7247",-1)),Jo=J("\u53D6 \u6D88"),Zo=J("\u786E \u5B9A"),Ko={__name:"UploadImgAny",props:{width:{type:Number,required:!1,default:200},height:{type:Number,required:!1,default:200},dir:{type:String,required:!0,default:"upload"}},emits:["saveImg"],setup(e,{expose:r,emit:t}){const o=e;let{MyIcon:n}=dt(),{timeFile:i}=at(),{upload:l}=Ct();Qe(()=>(console.log(o.width),console.log(o.height),Object.is(o.width,NaN)&&Object.is(o.height,NaN)?o.width/o.height:1));const s=W(null),d=W(""),a=W(!1),p=u=>{let c;"raw"in u?(console.log("element\u5BF9\u8C61"),c=u.raw):(console.log("\u539F\u751F\u5BF9\u8C61"),c=u.target.files[0]);const h=new FileReader;h.onload=f=>{d.value=f.target.result},h.readAsDataURL(c),a.value=!0},m=Ie({}),b=u=>{Object.assign(m,u)},C=u=>{u=u||1,s.value.changeScale(u)},x=u=>{u===1?s.value.rotateLeft():s.value.rotateRight()},w=()=>{s.value.refresh()},y=W(!1),g=()=>{s.value.getCropBlob(u=>{console.log(u),y.value=!0;const c=new File([u],i(Date.now())+".jpg",{type:u.type});console.log(c),l(o.dir,c).then(h=>{console.log(h),oe({message:"\u56FE\u7247\u4E0A\u4F20\u6210\u529F\uFF01",type:"success"}),t("saveImg",h),a.value=!1,y.value=!1}).catch(h=>{console.log(h),oe.error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF01"),y.value=!1})})};return r({test:()=>{console.log("\u8FD9\u662F\u56FE\u7247\u4E0A\u4F20\u7EC4\u4EF6\u7684\u65B9\u6CD5")},uploadChange:p}),(u,c)=>{const h=Ee,f=et,M=it,F=tt,X=nt;return j(),Y("div",null,[_(f,{accept:".jpg,.jpeg,.png",action:"./","auto-upload":!1,"on-change":p,"show-file-list":!1},{default:T(()=>[_(h,{class:"upload-btn",size:"large"},{default:T(()=>[_($(n),{class:"upload-icon",type:"icon-upload-img"}),Do]),_:1})]),_:1}),_(F,{title:"\u56FE\u7247\u88C1\u526A",modelValue:a.value,"onUpdate:modelValue":c[7]||(c[7]=H=>a.value=H),"append-to-body":"",center:""},{footer:T(()=>[_(h,{type:"success"},{default:T(()=>[Go]),_:1}),E("input",{type:"file",id:"uploads",style:{position:"absolute",clip:"rect(0 0 0 0)"},accept:"image/png, image/jpeg, image/jpg",onChange:c[0]||(c[0]=H=>p(H))},null,32),_(M,{class:"cropper-btn-group"},{default:T(()=>[_(h,{type:"primary",plain:"",onClick:c[1]||(c[1]=H=>C(1))},{default:T(()=>[_($(n),{type:"icon-amplification"})]),_:1}),_(h,{type:"primary",plain:"",onClick:c[2]||(c[2]=H=>C(-1))},{default:T(()=>[_($(n),{type:"icon-narrow"})]),_:1}),_(h,{type:"primary",plain:"",onClick:c[3]||(c[3]=H=>w())},{default:T(()=>[_($(n),{type:"icon-reset"})]),_:1}),_(h,{type:"primary",plain:"",onClick:c[4]||(c[4]=H=>x(1))},{default:T(()=>[_($(n),{type:"icon-clockwise-sense"})]),_:1}),_(h,{type:"primary",plain:"",onClick:c[5]||(c[5]=H=>x(-1))},{default:T(()=>[_($(n),{type:"icon-clockwise-dirction"})]),_:1})]),_:1}),_(h,{onClick:c[6]||(c[6]=H=>a.value=!1)},{default:T(()=>[Jo]),_:1}),_(h,{type:"primary",onClick:g},{default:T(()=>[Zo]),_:1})]),default:T(()=>[G((j(),Y("div",qo,[E("span",Vo,[_($(He),{ref_key:"cropper",ref:s,img:d.value,autoCrop:!0,onRealTime:b},null,8,["img"])])])),[[X,y.value]])]),_:1},8,["modelValue"])])}}};var Qo=Me(Ko,[["__scopeId","data-v-43fcf7c0"]]);const ei={class:"main"},ti={class:"img-tips"},ri=J("\u590D\u5236\u56FE\u7247\u5730\u5740"),oi=J("\u53D6\u6D88"),ii={__name:"Image",setup(e){const{toClipboard:r}=Jt(),t=Ie({value:"",directory:"",url:"",width:100,height:100}),o=[{value:0,directory:"articleCover",label:"\u6587\u7AE0\u5C01\u9762",width:540,height:360},{value:1,directory:"noteCover",label:"\u7B14\u8BB0\u5C01\u9762",width:425,height:225},{value:2,directory:"carousel",label:"\u8F6E\u64AD\u56FE",width:900,height:500},{value:3,directory:"markdown",label:"\u5BCC\u6587\u672C\u56FE\u7247",width:NaN,height:NaN},{value:4,directory:"link",label:"\u53CB\u60C5\u94FE\u63A5",width:50,height:50},{value:5,directory:"photo",label:"\u7528\u6237\u5934\u50CF",width:50,height:50},{value:6,directory:"image",label:"\u5176\u4ED6\u56FE\u7247",width:NaN,height:NaN}],n=d=>{console.log(d),t.directory=o[d].directory,t.width=o[d].width,t.height=o[d].height},i=d=>{console.log(d),t.url=d},l=()=>{console.log("\u590D\u5236\u4E86\u554A");try{r(t.url),console.log(t.url),oe({message:"\u56FE\u7247\u94FE\u63A5\u6210\u529F\u590D\u5236\u5230\u526A\u5207\u677F\uFF01",type:"success"})}catch(d){console.error(d)}},s=()=>{t.url="",t.directory=""};return(d,a)=>{const p=jt,m=Bt,b=Yt,C=Rt,x=Ee,w=Wt,y=Nt;return j(),Y("div",ei,[_(y,{shadow:"hover"},{default:T(()=>[_(w,{model:t,"label-width":"120px"},{default:T(()=>[_(b,{label:"\u56FE\u7247\u7C7B\u578B\uFF1A"},{default:T(()=>[_(m,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=g=>t.value=g),onChange:n,placeholder:"\u8BF7\u9009\u62E9\u4E0A\u4F20\u56FE\u7247\u7C7B\u578B",size:"large"},{default:T(()=>[(j(),Y(Dt,null,qt(o,g=>_(p,{key:g.value,label:g.label,value:g.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),G(E("span",ti,[E("p",null,"\u56FE\u7247\u4E0A\u4F20\u76EE\u5F55\uFF1A"+ee(t.directory),1),E("p",null,"\u56FE\u7247\u4E0A\u4F20\u5C3A\u5BF8\uFF1A"+ee(t.width)+" X "+ee(t.height),1)],512),[[ge,t.directory]])]),_:1}),t.width?(j(),Pe(b,{key:0,label:"\u56FE\u7247\u4E0A\u4F20\uFF1A"},{default:T(()=>[_(No,{width:t.width,height:t.height,dir:t.directory,onSaveImg:i},null,8,["width","height","dir"])]),_:1})):(j(),Pe(b,{key:1,label:"\u56FE\u7247\u4E0A\u4F20\uFF1A"},{default:T(()=>[_(Qo,{dir:t.directory,onSaveImg:i},null,8,["dir"])]),_:1})),G(_(b,{label:"\u56FE\u7247\u9884\u89C8\uFF1A"},{default:T(()=>[_(C,{src:t.url,fit:"contain"},null,8,["src"])]),_:1},512),[[ge,t.url]]),_(b,null,{default:T(()=>[_(x,{type:"primary",onClick:l,size:"large"},{default:T(()=>[ri]),_:1}),_(x,{onClick:s,size:"large"},{default:T(()=>[oi]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}};var ui=Me(ii,[["__scopeId","data-v-be5577fe"]]);export{ui as default};
